{
  "version": "1.0",
  "conceptualSchemaSettings": {},
  "queries": [
    {
      "name": "Region City Entries",
      "lineageTag": "cd9282a6-a4f2-4e58-a433-a8b831f90830",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Databases(\"localhost\\SQLEXPRESS\"),",
        "    a_levels_study_db = Source{[Name=\"a_levels_study_db\"]}[Data],",
        "    dbo_city_region_entries = a_levels_study_db{[Schema=\"dbo\",Item=\"city_region_entries\"]}[Data],",
        "    #\"Renamed Columns\" = Table.RenameColumns(dbo_city_region_entries,{{\"entry_count\", \"Entries\"}, {\"entry_per_region\", \"Entries Per Region\"}}),",
        "    #\"Removed Columns\" = Table.RemoveColumns(#\"Renamed Columns\",{\"Entries Per Region\", \"total_entries\"}),",
        "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Removed Columns\",{{\"la_name\", \"City\"}, {\"region_name\", \"Region\"}})",
        "in",
        "    #\"Renamed Columns1\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Databases(\\\"localhost\\\\SQLEXPRESS\\\"),\\n    a_levels_study_db = Source{[Name=\\\"a_levels_study_db\\\"]}[Data],\\n    dbo_city_region_entries = a_levels_study_db{[Schema=\\\"dbo\\\",Item=\\\"city_region_entries\\\"]}[Data],\\n    #\\\"Renamed Columns\\\" = Table.RenameColumns(dbo_city_region_entries,{{\\\"entry_count\\\", \\\"Entries\\\"}, {\\\"entry_per_region\\\", \\\"Entries Per Region\\\"}}),\\n    #\\\"Removed Columns\\\" = Table.RemoveColumns(#\\\"Renamed Columns\\\",{\\\"Entries Per Region\\\", \\\"total_entries\\\"}),\\n    #\\\"Renamed Columns1\\\" = Table.RenameColumns(#\\\"Removed Columns\\\",{{\\\"la_name\\\", \\\"City\\\"}, {\\\"region_name\\\", \\\"Region\\\"}})\\nin\\n    #\\\"Renamed Columns1\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "Maths Science",
      "lineageTag": "5aa60048-7740-40ff-9a28-6205ea2a8c94",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Databases(\"localhost\\SQLEXPRESS\"),",
        "    a_levels_study_db = Source{[Name=\"a_levels_study_db\"]}[Data],",
        "    dbo_math_science = a_levels_study_db{[Schema=\"dbo\",Item=\"math_science\"]}[Data],",
        "    #\"Sorted Rows\" = Table.Sort(dbo_math_science,{{\"URN\", Order.Ascending}}),",
        "    #\"Removed Duplicates\" = Table.Distinct(#\"Sorted Rows\", {\"URN\"}),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Duplicates\",{{\"Female_A_levels_students\", \"Female A-level Students\"}, {\"Male_A_levels_students\", \"Male A-level Students\"}, {\"All_A_levels_students\", \"All A-Level Students\"}}),",
        "    #\"Sorted Rows1\" = Table.Sort(#\"Renamed Columns\",{{\"A_level_maths_percent_all\", Order.Ascending}})",
        "in",
        "    #\"Sorted Rows1\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Databases(\\\"localhost\\\\SQLEXPRESS\\\"),\\n    a_levels_study_db = Source{[Name=\\\"a_levels_study_db\\\"]}[Data],\\n    dbo_math_science = a_levels_study_db{[Schema=\\\"dbo\\\",Item=\\\"math_science\\\"]}[Data],\\n    #\\\"Sorted Rows\\\" = Table.Sort(dbo_math_science,{{\\\"URN\\\", Order.Ascending}}),\\n    #\\\"Removed Duplicates\\\" = Table.Distinct(#\\\"Sorted Rows\\\", {\\\"URN\\\"}),\\n    #\\\"Renamed Columns\\\" = Table.RenameColumns(#\\\"Removed Duplicates\\\",{{\\\"Female_A_levels_students\\\", \\\"Female A-level Students\\\"}, {\\\"Male_A_levels_students\\\", \\\"Male A-level Students\\\"}, {\\\"All_A_levels_students\\\", \\\"All A-Level Students\\\"}}),\\n    #\\\"Sorted Rows1\\\" = Table.Sort(#\\\"Renamed Columns\\\",{{\\\"A_level_maths_percent_all\\\", Order.Ascending}})\\nin\\n    #\\\"Sorted Rows1\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "school_information_updated",
      "lineageTag": "47ab5930-4cd2-4eae-ad39-aa594d3af448",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Databases(\"localhost\\SQLEXPRESS\"),",
        "    a_levels_study_db = Source{[Name=\"a_levels_study_db\"]}[Data],",
        "    dbo_school_information_updated = a_levels_study_db{[Schema=\"dbo\",Item=\"school_information_updated\"]}[Data],",
        "    #\"Filtered Rows\" = Table.SelectRows(dbo_school_information_updated, each [OFSTED_visit] <> null and [OFSTED_visit] <> \"\"),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Filtered Rows\",{{\"OFSTED_visit\", \"OFSTED Visit Date\"}, {\"Location\", \"City\"}})",
        "in",
        "    #\"Renamed Columns\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Databases(\\\"localhost\\\\SQLEXPRESS\\\"),\\n    a_levels_study_db = Source{[Name=\\\"a_levels_study_db\\\"]}[Data],\\n    dbo_school_information_updated = a_levels_study_db{[Schema=\\\"dbo\\\",Item=\\\"school_information_updated\\\"]}[Data],\\n    #\\\"Filtered Rows\\\" = Table.SelectRows(dbo_school_information_updated, each [OFSTED_visit] <> null and [OFSTED_visit] <> \\\"\\\"),\\n    #\\\"Renamed Columns\\\" = Table.RenameColumns(#\\\"Filtered Rows\\\",{{\\\"OFSTED_visit\\\", \\\"OFSTED Visit Date\\\"}, {\\\"Location\\\", \\\"City\\\"}})\\nin\\n    #\\\"Renamed Columns\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "Student Progression",
      "lineageTag": "c7979ebb-4831-4355-b9a4-92f1b5d4d909",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Databases(\"localhost\\SQLEXPRESS\"),",
        "    a_levels_study_db = Source{[Name=\"a_levels_study_db\"]}[Data],",
        "    dbo_student_progressions = a_levels_study_db{[Schema=\"dbo\",Item=\"student_progressions\"]}[Data],",
        "    #\"Renamed Columns\" = Table.RenameColumns(dbo_student_progressions,{{\"OxfordorCambridge\", \"Progressed to Oxbridge\"}, {\"RussellGroupInstitution\", \"Progressed to Russell Group\"}, {\"SustainedLevel4or5destination\", \"Progressed to Level 4 or 5 Study\"}, {\"SustainedApprenticeshipDestination\", \"Progressed to Apprenticeship\"}}),",
        "    #\"Replaced Value\" = Table.ReplaceValue(#\"Renamed Columns\",\"SUPP\",\"0\",Replacer.ReplaceText,{\"Progressed to Oxbridge\"}),",
        "    #\"Replaced Value1\" = Table.ReplaceValue(#\"Replaced Value\",\"SUPP\",\"0\",Replacer.ReplaceText,{\"studying4level3qual\", \"sustainedL4above\", \"Progressed to Apprenticeship\", \"ALL_HE\", \"TopthirdHEdestination\", \"Progressed to Russell Group\", \"Progressed to Oxbridge\", \"Progressed to Level 4 or 5 Study\"}),",
        "    #\"Replaced Value2\" = Table.ReplaceValue(#\"Replaced Value1\",\"SP\",\"0\",Replacer.ReplaceText,{\"studying4level3qual\", \"sustainedL4above\", \"Progressed to Apprenticeship\", \"ALL_HE\", \"TopthirdHEdestination\", \"Progressed to Russell Group\", \"Progressed to Oxbridge\", \"Progressed to Level 4 or 5 Study\"}),",
        "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Replaced Value2\",{{\"Progressed to Level 4 or 5 Study\", Percentage.Type}, {\"Progressed to Oxbridge\", Percentage.Type}, {\"Progressed to Russell Group\", Percentage.Type}, {\"TopthirdHEdestination\", Percentage.Type}, {\"ALL_HE\", Percentage.Type}, {\"Progressed to Apprenticeship\", Percentage.Type}, {\"sustainedL4above\", Percentage.Type}, {\"studying4level3qual\", Int64.Type}}),",
        "    #\"Filtered Rows\" = Table.SelectRows(#\"Changed Type\", each true),",
        "    #\"Sorted Rows\" = Table.Sort(#\"Filtered Rows\",{{\"Progressed to Apprenticeship\", Order.Ascending}}),",
        "    #\"Filtered Rows1\" = Table.SelectRows(#\"Sorted Rows\", each true),",
        "    #\"Sorted Rows1\" = Table.Sort(#\"Filtered Rows1\",{{\"Progressed to Apprenticeship\", Order.Ascending}}),",
        "    #\"Filtered Rows2\" = Table.SelectRows(#\"Sorted Rows1\", each true),",
        "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Filtered Rows2\",{{\"Progressed to Apprenticeship\", \"Progress to Apprenticeships\"}, {\"Progressed to Level 4 or 5 Study\", \"Progress to Level 4 or 5 Studies\"}, {\"Progressed to Oxbridge\", \"Progress to Oxford or Cambridge\"}, {\"Progressed to Russell Group\", \"Progress to Russell Group Institutions\"}})",
        "in",
        "    #\"Renamed Columns1\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Databases(\\\"localhost\\\\SQLEXPRESS\\\"),\\n    a_levels_study_db = Source{[Name=\\\"a_levels_study_db\\\"]}[Data],\\n    dbo_student_progressions = a_levels_study_db{[Schema=\\\"dbo\\\",Item=\\\"student_progressions\\\"]}[Data],\\n    #\\\"Renamed Columns\\\" = Table.RenameColumns(dbo_student_progressions,{{\\\"OxfordorCambridge\\\", \\\"Progressed to Oxbridge\\\"}, {\\\"RussellGroupInstitution\\\", \\\"Progressed to Russell Group\\\"}, {\\\"SustainedLevel4or5destination\\\", \\\"Progressed to Level 4 or 5 Study\\\"}, {\\\"SustainedApprenticeshipDestination\\\", \\\"Progressed to Apprenticeship\\\"}}),\\n    #\\\"Replaced Value\\\" = Table.ReplaceValue(#\\\"Renamed Columns\\\",\\\"SUPP\\\",\\\"0\\\",Replacer.ReplaceText,{\\\"Progressed to Oxbridge\\\"}),\\n    #\\\"Replaced Value1\\\" = Table.ReplaceValue(#\\\"Replaced Value\\\",\\\"SUPP\\\",\\\"0\\\",Replacer.ReplaceText,{\\\"studying4level3qual\\\", \\\"sustainedL4above\\\", \\\"Progressed to Apprenticeship\\\", \\\"ALL_HE\\\", \\\"TopthirdHEdestination\\\", \\\"Progressed to Russell Group\\\", \\\"Progressed to Oxbridge\\\", \\\"Progressed to Level 4 or 5 Study\\\"}),\\n    #\\\"Replaced Value2\\\" = Table.ReplaceValue(#\\\"Replaced Value1\\\",\\\"SP\\\",\\\"0\\\",Replacer.ReplaceText,{\\\"studying4level3qual\\\", \\\"sustainedL4above\\\", \\\"Progressed to Apprenticeship\\\", \\\"ALL_HE\\\", \\\"TopthirdHEdestination\\\", \\\"Progressed to Russell Group\\\", \\\"Progressed to Oxbridge\\\", \\\"Progressed to Level 4 or 5 Study\\\"}),\\n    #\\\"Changed Type\\\" = Table.TransformColumnTypes(#\\\"Replaced Value2\\\",{{\\\"Progressed to Level 4 or 5 Study\\\", Percentage.Type}, {\\\"Progressed to Oxbridge\\\", Percentage.Type}, {\\\"Progressed to Russell Group\\\", Percentage.Type}, {\\\"TopthirdHEdestination\\\", Percentage.Type}, {\\\"ALL_HE\\\", Percentage.Type}, {\\\"Progressed to Apprenticeship\\\", Percentage.Type}, {\\\"sustainedL4above\\\", Percentage.Type}, {\\\"studying4level3qual\\\", Int64.Type}}),\\n    #\\\"Filtered Rows\\\" = Table.SelectRows(#\\\"Changed Type\\\", each true),\\n    #\\\"Sorted Rows\\\" = Table.Sort(#\\\"Filtered Rows\\\",{{\\\"Progressed to Apprenticeship\\\", Order.Ascending}}),\\n    #\\\"Filtered Rows1\\\" = Table.SelectRows(#\\\"Sorted Rows\\\", each true),\\n    #\\\"Sorted Rows1\\\" = Table.Sort(#\\\"Filtered Rows1\\\",{{\\\"Progressed to Apprenticeship\\\", Order.Ascending}}),\\n    #\\\"Filtered Rows2\\\" = Table.SelectRows(#\\\"Sorted Rows1\\\", each true),\\n    #\\\"Renamed Columns1\\\" = Table.RenameColumns(#\\\"Filtered Rows2\\\",{{\\\"Progressed to Apprenticeship\\\", \\\"Progress to Apprenticeships\\\"}, {\\\"Progressed to Level 4 or 5 Study\\\", \\\"Progress to Level 4 or 5 Studies\\\"}, {\\\"Progressed to Oxbridge\\\", \\\"Progress to Oxford or Cambridge\\\"}, {\\\"Progressed to Russell Group\\\", \\\"Progress to Russell Group Institutions\\\"}})\\nin\\n    #\\\"Renamed Columns1\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "Oftsted Information",
      "lineageTag": "417b188b-348c-4714-b00b-d8803f7758f5",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Table.NestedJoin(school_information_updated, {\"City\"}, #\"Region City Entries\", {\"City\"}, \"Region City Entries\", JoinKind.RightOuter),",
        "    #\"Expanded Region City Entries\" = Table.ExpandTableColumn(Source, \"Region City Entries\", {\"Region\", \"City\", \"Entries\"}, {\"Region City Entries.Region\", \"Region City Entries.City\", \"Region City Entries.Entries\"}),",
        "    #\"Removed Columns\" = Table.RemoveColumns(#\"Expanded Region City Entries\",{\"Region City Entries.Entries\"}),",
        "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Removed Columns\",{\"URN\", \"Region City Entries.City\", \"Region City Entries.Region\", \"City\", \"School\", \"Town\", \"Post_code\", \"Other_grouping\", \"School_type\", \"Age_grouping\", \"Gender\", \"Associated_with\", \"Admission_policy\", \"OFTSTED_rating\", \"OFSTED Visit Date\"}),",
        "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Reordered Columns\",{\"Region City Entries.City\", \"Town\"}),",
        "    #\"Reordered Columns1\" = Table.ReorderColumns(#\"Removed Columns1\",{\"URN\", \"Region City Entries.Region\", \"City\", \"Post_code\", \"School\", \"Other_grouping\", \"School_type\", \"Age_grouping\", \"Gender\", \"Associated_with\", \"Admission_policy\", \"OFTSTED_rating\", \"OFSTED Visit Date\"}),",
        "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Reordered Columns1\",{\"Region City Entries.Region\", \"City\"}),",
        "    #\"Reordered Columns2\" = Table.ReorderColumns(#\"Removed Columns2\",{\"URN\", \"School\", \"Other_grouping\", \"School_type\", \"Post_code\", \"Age_grouping\", \"Gender\", \"Associated_with\", \"Admission_policy\", \"OFTSTED_rating\", \"OFSTED Visit Date\"}),",
        "    #\"Replaced Value\" = Table.ReplaceValue(#\"Reordered Columns2\",\"MATURE\",\"Adult\",Replacer.ReplaceText,{\"Age_grouping\"}),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Replaced Value\",{{\"OFSTED Visit Date\", \"OFTSTED Visit Date\"}, {\"OFTSTED_rating\", \"OFTSTED Rating\"}, {\"Other_grouping\", \"Other Groupings\"}, {\"Post_code\", \"Postcode\"}}),",
        "    #\"Replaced Value1\" = Table.ReplaceValue(#\"Renamed Columns\",\"\",\"No Rating Provided\",Replacer.ReplaceValue,{\"OFTSTED Rating\"}),",
        "    #\"Replaced Value2\" = Table.ReplaceValue(#\"Replaced Value1\",\"NULL\",\"No Rating Provided\",Replacer.ReplaceText,{\"OFTSTED Rating\"}),",
        "    #\"Replaced Value3\" = Table.ReplaceValue(#\"Replaced Value2\",null,\"No Rating\",Replacer.ReplaceValue,{\"OFTSTED Rating\"}),",
        "    #\"Replaced Value4\" = Table.ReplaceValue(#\"Replaced Value3\",null,\"Policy not Provided\",Replacer.ReplaceValue,{\"Admission_policy\"}),",
        "    #\"Replaced Value5\" = Table.ReplaceValue(#\"Replaced Value4\",null,\"Not Associated\",Replacer.ReplaceValue,{\"Associated_with\"}),",
        "    #\"Replaced Value6\" = Table.ReplaceValue(#\"Replaced Value5\",null,\"No Gender\",Replacer.ReplaceValue,{\"Gender\"}),",
        "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Replaced Value6\",{{\"Other Groupings\", \"Other Groupings\"}}),",
        "    #\"Trimmed Text\" = Table.TransformColumns(#\"Renamed Columns1\",{{\"OFTSTED Rating\", Text.Trim, type text}}),",
        "    #\"Cleaned Text\" = Table.TransformColumns(#\"Trimmed Text\",{{\"OFTSTED Rating\", Text.Clean, type text}}),",
        "    #\"Filtered Rows\" = Table.SelectRows(#\"Cleaned Text\", each ([OFTSTED Visit Date] <> null and [OFTSTED Visit Date] <> \"\")),",
        "    #\"Replaced Value7\" = Table.ReplaceValue(#\"Filtered Rows\",null,\"Not Available\",Replacer.ReplaceValue,{\"Age_grouping\"}),",
        "    #\"Renamed Columns2\" = Table.RenameColumns(#\"Replaced Value7\",{{\"Other Groupings\", \"School Group\"}, {\"School_type\", \"School Type\"}, {\"Age_grouping\", \"Age Group\"}, {\"Associated_with\", \"Associated With\"}, {\"Admission_policy\", \"Admission Policy\"}}),",
        "    #\"Lowercased Text\" = Table.TransformColumns(#\"Renamed Columns2\",{{\"OFTSTED Rating\", Text.Lower, type text}}),",
        "    #\"Trimmed Text1\" = Table.TransformColumns(#\"Lowercased Text\",{{\"OFTSTED Rating\", Text.Trim, type text}}),",
        "    #\"Removed Columns3\" = Table.RemoveColumns(#\"Trimmed Text1\",{\"School Group\", \"School Type\", \"Postcode\", \"Age Group\", \"Gender\", \"Associated With\", \"Admission Policy\"})",
        "in",
        "    #\"Removed Columns3\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Table.NestedJoin(school_information_updated, {\\\"City\\\"}, #\\\"Region City Entries\\\", {\\\"City\\\"}, \\\"Region City Entries\\\", JoinKind.RightOuter),\\n    #\\\"Expanded Region City Entries\\\" = Table.ExpandTableColumn(Source, \\\"Region City Entries\\\", {\\\"Region\\\", \\\"City\\\", \\\"Entries\\\"}, {\\\"Region City Entries.Region\\\", \\\"Region City Entries.City\\\", \\\"Region City Entries.Entries\\\"}),\\n    #\\\"Removed Columns\\\" = Table.RemoveColumns(#\\\"Expanded Region City Entries\\\",{\\\"Region City Entries.Entries\\\"}),\\n    #\\\"Reordered Columns\\\" = Table.ReorderColumns(#\\\"Removed Columns\\\",{\\\"URN\\\", \\\"Region City Entries.City\\\", \\\"Region City Entries.Region\\\", \\\"City\\\", \\\"School\\\", \\\"Town\\\", \\\"Post_code\\\", \\\"Other_grouping\\\", \\\"School_type\\\", \\\"Age_grouping\\\", \\\"Gender\\\", \\\"Associated_with\\\", \\\"Admission_policy\\\", \\\"OFTSTED_rating\\\", \\\"OFSTED Visit Date\\\"}),\\n    #\\\"Removed Columns1\\\" = Table.RemoveColumns(#\\\"Reordered Columns\\\",{\\\"Region City Entries.City\\\", \\\"Town\\\"}),\\n    #\\\"Reordered Columns1\\\" = Table.ReorderColumns(#\\\"Removed Columns1\\\",{\\\"URN\\\", \\\"Region City Entries.Region\\\", \\\"City\\\", \\\"Post_code\\\", \\\"School\\\", \\\"Other_grouping\\\", \\\"School_type\\\", \\\"Age_grouping\\\", \\\"Gender\\\", \\\"Associated_with\\\", \\\"Admission_policy\\\", \\\"OFTSTED_rating\\\", \\\"OFSTED Visit Date\\\"}),\\n    #\\\"Removed Columns2\\\" = Table.RemoveColumns(#\\\"Reordered Columns1\\\",{\\\"Region City Entries.Region\\\", \\\"City\\\"}),\\n    #\\\"Reordered Columns2\\\" = Table.ReorderColumns(#\\\"Removed Columns2\\\",{\\\"URN\\\", \\\"School\\\", \\\"Other_grouping\\\", \\\"School_type\\\", \\\"Post_code\\\", \\\"Age_grouping\\\", \\\"Gender\\\", \\\"Associated_with\\\", \\\"Admission_policy\\\", \\\"OFTSTED_rating\\\", \\\"OFSTED Visit Date\\\"}),\\n    #\\\"Replaced Value\\\" = Table.ReplaceValue(#\\\"Reordered Columns2\\\",\\\"MATURE\\\",\\\"Adult\\\",Replacer.ReplaceText,{\\\"Age_grouping\\\"}),\\n    #\\\"Renamed Columns\\\" = Table.RenameColumns(#\\\"Replaced Value\\\",{{\\\"OFSTED Visit Date\\\", \\\"OFTSTED Visit Date\\\"}, {\\\"OFTSTED_rating\\\", \\\"OFTSTED Rating\\\"}, {\\\"Other_grouping\\\", \\\"Other Groupings\\\"}, {\\\"Post_code\\\", \\\"Postcode\\\"}}),\\n    #\\\"Replaced Value1\\\" = Table.ReplaceValue(#\\\"Renamed Columns\\\",\\\"\\\",\\\"No Rating Provided\\\",Replacer.ReplaceValue,{\\\"OFTSTED Rating\\\"}),\\n    #\\\"Replaced Value2\\\" = Table.ReplaceValue(#\\\"Replaced Value1\\\",\\\"NULL\\\",\\\"No Rating Provided\\\",Replacer.ReplaceText,{\\\"OFTSTED Rating\\\"}),\\n    #\\\"Replaced Value3\\\" = Table.ReplaceValue(#\\\"Replaced Value2\\\",null,\\\"No Rating\\\",Replacer.ReplaceValue,{\\\"OFTSTED Rating\\\"}),\\n    #\\\"Replaced Value4\\\" = Table.ReplaceValue(#\\\"Replaced Value3\\\",null,\\\"Policy not Provided\\\",Replacer.ReplaceValue,{\\\"Admission_policy\\\"}),\\n    #\\\"Replaced Value5\\\" = Table.ReplaceValue(#\\\"Replaced Value4\\\",null,\\\"Not Associated\\\",Replacer.ReplaceValue,{\\\"Associated_with\\\"}),\\n    #\\\"Replaced Value6\\\" = Table.ReplaceValue(#\\\"Replaced Value5\\\",null,\\\"No Gender\\\",Replacer.ReplaceValue,{\\\"Gender\\\"})\\nin\\n    #\\\"Replaced Value6\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "Regional Information",
      "lineageTag": "39c39dd5-c642-4085-b82a-c7090cd619c4",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Table.NestedJoin(school_information_updated, {\"City\"}, #\"Region City Entries\", {\"City\"}, \"Region City Entries\", JoinKind.RightOuter),",
        "    #\"Expanded Region City Entries\" = Table.ExpandTableColumn(Source, \"Region City Entries\", {\"Region\", \"City\", \"Entries\"}, {\"Region City Entries.Region\", \"Region City Entries.City\", \"Region City Entries.Entries\"}),",
        "    #\"Removed Columns\" = Table.RemoveColumns(#\"Expanded Region City Entries\",{\"Region City Entries.Entries\"}),",
        "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Removed Columns\",{\"URN\", \"Region City Entries.City\", \"Region City Entries.Region\", \"City\", \"School\", \"Town\", \"Post_code\", \"Other_grouping\", \"School_type\", \"Age_grouping\", \"Gender\", \"Associated_with\", \"Admission_policy\", \"OFTSTED_rating\", \"OFSTED Visit Date\"}),",
        "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Reordered Columns\",{\"Region City Entries.City\", \"Town\"}),",
        "    #\"Reordered Columns1\" = Table.ReorderColumns(#\"Removed Columns1\",{\"URN\", \"Region City Entries.Region\", \"City\", \"Post_code\", \"School\", \"Other_grouping\", \"School_type\", \"Age_grouping\", \"Gender\", \"Associated_with\", \"Admission_policy\", \"OFTSTED_rating\", \"OFSTED Visit Date\"}),",
        "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Reordered Columns1\",{\"School\", \"Other_grouping\", \"School_type\", \"Age_grouping\", \"Gender\", \"Associated_with\", \"Admission_policy\", \"OFTSTED_rating\", \"OFSTED Visit Date\", \"URN\"}),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns2\",{{\"Region City Entries.Region\", \"Region\"}}),",
        "    #\"Merged Queries\" = Table.NestedJoin(#\"Renamed Columns\", {\"Post_code\"}, school_information_updated, {\"Post_code\"}, \"school_information_updated\", JoinKind.LeftOuter),",
        "    #\"Expanded school_information_updated\" = Table.ExpandTableColumn(#\"Merged Queries\", \"school_information_updated\", {\"URN\"}, {\"school_information_updated.URN\"}),",
        "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Expanded school_information_updated\",{{\"school_information_updated.URN\", \"URN\"}}),",
        "    #\"Removed Top Rows\" = Table.Skip(#\"Renamed Columns1\",1),",
        "    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Top Rows\", {\"URN\"})",
        "in",
        "    #\"Removed Duplicates\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Table.NestedJoin(school_information_updated, {\\\"City\\\"}, #\\\"Region City Entries\\\", {\\\"City\\\"}, \\\"Region City Entries\\\", JoinKind.RightOuter),\\n    #\\\"Expanded Region City Entries\\\" = Table.ExpandTableColumn(Source, \\\"Region City Entries\\\", {\\\"Region\\\", \\\"City\\\", \\\"Entries\\\"}, {\\\"Region City Entries.Region\\\", \\\"Region City Entries.City\\\", \\\"Region City Entries.Entries\\\"}),\\n    #\\\"Removed Columns\\\" = Table.RemoveColumns(#\\\"Expanded Region City Entries\\\",{\\\"Region City Entries.Entries\\\"}),\\n    #\\\"Reordered Columns\\\" = Table.ReorderColumns(#\\\"Removed Columns\\\",{\\\"URN\\\", \\\"Region City Entries.City\\\", \\\"Region City Entries.Region\\\", \\\"City\\\", \\\"School\\\", \\\"Town\\\", \\\"Post_code\\\", \\\"Other_grouping\\\", \\\"School_type\\\", \\\"Age_grouping\\\", \\\"Gender\\\", \\\"Associated_with\\\", \\\"Admission_policy\\\", \\\"OFTSTED_rating\\\", \\\"OFSTED Visit Date\\\"}),\\n    #\\\"Removed Columns1\\\" = Table.RemoveColumns(#\\\"Reordered Columns\\\",{\\\"Region City Entries.City\\\", \\\"Town\\\"}),\\n    #\\\"Reordered Columns1\\\" = Table.ReorderColumns(#\\\"Removed Columns1\\\",{\\\"URN\\\", \\\"Region City Entries.Region\\\", \\\"City\\\", \\\"Post_code\\\", \\\"School\\\", \\\"Other_grouping\\\", \\\"School_type\\\", \\\"Age_grouping\\\", \\\"Gender\\\", \\\"Associated_with\\\", \\\"Admission_policy\\\", \\\"OFTSTED_rating\\\", \\\"OFSTED Visit Date\\\"}),\\n    #\\\"Removed Columns2\\\" = Table.RemoveColumns(#\\\"Reordered Columns1\\\",{\\\"School\\\", \\\"Other_grouping\\\", \\\"School_type\\\", \\\"Age_grouping\\\", \\\"Gender\\\", \\\"Associated_with\\\", \\\"Admission_policy\\\", \\\"OFTSTED_rating\\\", \\\"OFSTED Visit Date\\\", \\\"URN\\\"}),\\n    #\\\"Renamed Columns\\\" = Table.RenameColumns(#\\\"Removed Columns2\\\",{{\\\"Region City Entries.Region\\\", \\\"Region\\\"}}),\\n    #\\\"Merged Queries\\\" = Table.NestedJoin(#\\\"Renamed Columns\\\", {\\\"Post_code\\\"}, school_information_updated, {\\\"Post_code\\\"}, \\\"school_information_updated\\\", JoinKind.LeftOuter),\\n    #\\\"Expanded school_information_updated\\\" = Table.ExpandTableColumn(#\\\"Merged Queries\\\", \\\"school_information_updated\\\", {\\\"URN\\\"}, {\\\"school_information_updated.URN\\\"}),\\n    #\\\"Renamed Columns1\\\" = Table.RenameColumns(#\\\"Expanded school_information_updated\\\",{{\\\"school_information_updated.URN\\\", \\\"URN\\\"}}),\\n    #\\\"Removed Top Rows\\\" = Table.Skip(#\\\"Renamed Columns1\\\",1),\\n    #\\\"Removed Duplicates\\\" = Table.Distinct(#\\\"Removed Top Rows\\\", {\\\"URN\\\"})\\nin\\n    #\\\"Removed Duplicates\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "School Group and Type",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Table.NestedJoin(school_information_updated, {\"City\"}, #\"Region City Entries\", {\"City\"}, \"Region City Entries\", JoinKind.RightOuter),",
        "    #\"Expanded Region City Entries\" = Table.ExpandTableColumn(Source, \"Region City Entries\", {\"Region\", \"City\", \"Entries\"}, {\"Region City Entries.Region\", \"Region City Entries.City\", \"Region City Entries.Entries\"}),",
        "    #\"Removed Columns\" = Table.RemoveColumns(#\"Expanded Region City Entries\",{\"Region City Entries.Entries\"}),",
        "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Removed Columns\",{\"URN\", \"Region City Entries.City\", \"Region City Entries.Region\", \"City\", \"School\", \"Town\", \"Post_code\", \"Other_grouping\", \"School_type\", \"Age_grouping\", \"Gender\", \"Associated_with\", \"Admission_policy\", \"OFTSTED_rating\", \"OFSTED Visit Date\"}),",
        "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Reordered Columns\",{\"Region City Entries.City\", \"Town\"}),",
        "    #\"Reordered Columns1\" = Table.ReorderColumns(#\"Removed Columns1\",{\"URN\", \"Region City Entries.Region\", \"City\", \"Post_code\", \"School\", \"Other_grouping\", \"School_type\", \"Age_grouping\", \"Gender\", \"Associated_with\", \"Admission_policy\", \"OFTSTED_rating\", \"OFSTED Visit Date\"}),",
        "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Reordered Columns1\",{\"Region City Entries.Region\", \"City\"}),",
        "    #\"Reordered Columns2\" = Table.ReorderColumns(#\"Removed Columns2\",{\"URN\", \"School\", \"Other_grouping\", \"School_type\", \"Post_code\", \"Age_grouping\", \"Gender\", \"Associated_with\", \"Admission_policy\", \"OFTSTED_rating\", \"OFSTED Visit Date\"}),",
        "    #\"Replaced Value\" = Table.ReplaceValue(#\"Reordered Columns2\",\"MATURE\",\"Adult\",Replacer.ReplaceText,{\"Age_grouping\"}),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Replaced Value\",{{\"OFSTED Visit Date\", \"OFTSTED Visit Date\"}, {\"OFTSTED_rating\", \"OFTSTED Rating\"}, {\"Other_grouping\", \"Other Groupings\"}, {\"Post_code\", \"Postcode\"}}),",
        "    #\"Replaced Value1\" = Table.ReplaceValue(#\"Renamed Columns\",\"\",\"No Rating Provided\",Replacer.ReplaceValue,{\"OFTSTED Rating\"}),",
        "    #\"Replaced Value2\" = Table.ReplaceValue(#\"Replaced Value1\",\"NULL\",\"No Rating Provided\",Replacer.ReplaceText,{\"OFTSTED Rating\"}),",
        "    #\"Replaced Value3\" = Table.ReplaceValue(#\"Replaced Value2\",null,\"No Rating\",Replacer.ReplaceValue,{\"OFTSTED Rating\"}),",
        "    #\"Replaced Value4\" = Table.ReplaceValue(#\"Replaced Value3\",null,\"Policy not Provided\",Replacer.ReplaceValue,{\"Admission_policy\"}),",
        "    #\"Replaced Value5\" = Table.ReplaceValue(#\"Replaced Value4\",null,\"Not Associated\",Replacer.ReplaceValue,{\"Associated_with\"}),",
        "    #\"Replaced Value6\" = Table.ReplaceValue(#\"Replaced Value5\",null,\"No Gender\",Replacer.ReplaceValue,{\"Gender\"}),",
        "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Replaced Value6\",{{\"Other Groupings\", \"Other Groupings\"}}),",
        "    #\"Trimmed Text\" = Table.TransformColumns(#\"Renamed Columns1\",{{\"OFTSTED Rating\", Text.Trim, type text}}),",
        "    #\"Cleaned Text\" = Table.TransformColumns(#\"Trimmed Text\",{{\"OFTSTED Rating\", Text.Clean, type text}}),",
        "    #\"Filtered Rows\" = Table.SelectRows(#\"Cleaned Text\", each ([OFTSTED Visit Date] <> null and [OFTSTED Visit Date] <> \"\")),",
        "    #\"Replaced Value7\" = Table.ReplaceValue(#\"Filtered Rows\",null,\"Not Available\",Replacer.ReplaceValue,{\"Age_grouping\"}),",
        "    #\"Renamed Columns2\" = Table.RenameColumns(#\"Replaced Value7\",{{\"Other Groupings\", \"School Group\"}, {\"School_type\", \"School Type\"}, {\"Age_grouping\", \"Age Group\"}, {\"Associated_with\", \"Associated With\"}, {\"Admission_policy\", \"Admission Policy\"}}),",
        "    #\"Lowercased Text\" = Table.TransformColumns(#\"Renamed Columns2\",{{\"OFTSTED Rating\", Text.Lower, type text}}),",
        "    #\"Trimmed Text1\" = Table.TransformColumns(#\"Lowercased Text\",{{\"OFTSTED Rating\", Text.Trim, type text}}),",
        "    #\"Removed Columns3\" = Table.RemoveColumns(#\"Trimmed Text1\",{\"School\", \"Postcode\", \"OFTSTED Rating\", \"OFTSTED Visit Date\"})",
        "in",
        "    #\"Removed Columns3\""
      ],
      "isDirectQuery": false,
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "Other Details",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Table.NestedJoin(school_information_updated, {\"City\"}, #\"Region City Entries\", {\"City\"}, \"Region City Entries\", JoinKind.RightOuter),",
        "    #\"Expanded Region City Entries\" = Table.ExpandTableColumn(Source, \"Region City Entries\", {\"Region\", \"City\", \"Entries\"}, {\"Region City Entries.Region\", \"Region City Entries.City\", \"Region City Entries.Entries\"}),",
        "    #\"Removed Columns\" = Table.RemoveColumns(#\"Expanded Region City Entries\",{\"Region City Entries.Entries\"}),",
        "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Removed Columns\",{\"URN\", \"Region City Entries.City\", \"Region City Entries.Region\", \"City\", \"School\", \"Town\", \"Post_code\", \"Other_grouping\", \"School_type\", \"Age_grouping\", \"Gender\", \"Associated_with\", \"Admission_policy\", \"OFTSTED_rating\", \"OFSTED Visit Date\"}),",
        "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Reordered Columns\",{\"Region City Entries.City\", \"Town\"}),",
        "    #\"Reordered Columns1\" = Table.ReorderColumns(#\"Removed Columns1\",{\"URN\", \"Region City Entries.Region\", \"City\", \"Post_code\", \"School\", \"Other_grouping\", \"School_type\", \"Age_grouping\", \"Gender\", \"Associated_with\", \"Admission_policy\", \"OFTSTED_rating\", \"OFSTED Visit Date\"}),",
        "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Reordered Columns1\",{\"Region City Entries.Region\", \"City\"}),",
        "    #\"Reordered Columns2\" = Table.ReorderColumns(#\"Removed Columns2\",{\"URN\", \"School\", \"Other_grouping\", \"School_type\", \"Post_code\", \"Age_grouping\", \"Gender\", \"Associated_with\", \"Admission_policy\", \"OFTSTED_rating\", \"OFSTED Visit Date\"}),",
        "    #\"Replaced Value\" = Table.ReplaceValue(#\"Reordered Columns2\",\"MATURE\",\"Adult\",Replacer.ReplaceText,{\"Age_grouping\"}),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Replaced Value\",{{\"OFSTED Visit Date\", \"OFTSTED Visit Date\"}, {\"OFTSTED_rating\", \"OFTSTED Rating\"}, {\"Other_grouping\", \"Other Groupings\"}, {\"Post_code\", \"Postcode\"}}),",
        "    #\"Replaced Value1\" = Table.ReplaceValue(#\"Renamed Columns\",\"\",\"No Rating Provided\",Replacer.ReplaceValue,{\"OFTSTED Rating\"}),",
        "    #\"Replaced Value2\" = Table.ReplaceValue(#\"Replaced Value1\",\"NULL\",\"No Rating Provided\",Replacer.ReplaceText,{\"OFTSTED Rating\"}),",
        "    #\"Replaced Value3\" = Table.ReplaceValue(#\"Replaced Value2\",null,\"No Rating\",Replacer.ReplaceValue,{\"OFTSTED Rating\"}),",
        "    #\"Replaced Value4\" = Table.ReplaceValue(#\"Replaced Value3\",null,\"Policy not Provided\",Replacer.ReplaceValue,{\"Admission_policy\"}),",
        "    #\"Replaced Value5\" = Table.ReplaceValue(#\"Replaced Value4\",null,\"Not Associated\",Replacer.ReplaceValue,{\"Associated_with\"}),",
        "    #\"Replaced Value6\" = Table.ReplaceValue(#\"Replaced Value5\",null,\"No Gender\",Replacer.ReplaceValue,{\"Gender\"}),",
        "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Replaced Value6\",{{\"Other Groupings\", \"Other Groupings\"}}),",
        "    #\"Trimmed Text\" = Table.TransformColumns(#\"Renamed Columns1\",{{\"OFTSTED Rating\", Text.Trim, type text}}),",
        "    #\"Cleaned Text\" = Table.TransformColumns(#\"Trimmed Text\",{{\"OFTSTED Rating\", Text.Clean, type text}}),",
        "    #\"Filtered Rows\" = Table.SelectRows(#\"Cleaned Text\", each ([OFTSTED Visit Date] <> null and [OFTSTED Visit Date] <> \"\")),",
        "    #\"Replaced Value7\" = Table.ReplaceValue(#\"Filtered Rows\",null,\"Not Available\",Replacer.ReplaceValue,{\"Age_grouping\"}),",
        "    #\"Renamed Columns2\" = Table.RenameColumns(#\"Replaced Value7\",{{\"Other Groupings\", \"School Group\"}, {\"School_type\", \"School Type\"}, {\"Age_grouping\", \"Age Group\"}, {\"Associated_with\", \"Associated With\"}, {\"Admission_policy\", \"Admission Policy\"}}),",
        "    #\"Lowercased Text\" = Table.TransformColumns(#\"Renamed Columns2\",{{\"OFTSTED Rating\", Text.Lower, type text}}),",
        "    #\"Trimmed Text1\" = Table.TransformColumns(#\"Lowercased Text\",{{\"OFTSTED Rating\", Text.Trim, type text}}),",
        "    #\"Removed Columns3\" = Table.RemoveColumns(#\"Trimmed Text1\",{\"School\", \"Postcode\", \"School Group\", \"School Type\", \"Age Group\", \"Gender\", \"OFTSTED Rating\", \"OFTSTED Visit Date\"})",
        "in",
        "    #\"Removed Columns3\""
      ],
      "isDirectQuery": false,
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    }
  ],
  "queryGroups": [],
  "culture": "en-GB",
  "firewallEnabled": true
}