{
  "version": "1.0",
  "conceptualSchemaSettings": {},
  "queries": [
    {
      "name": "Maths and Science Scores",
      "lineageTag": "39923177-3603-4180-89e9-38eb7ad76836",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Databases(\"localhost\\SQLEXPRESS\"),",
        "    a_levels_study_db = Source{[Name=\"a_levels_study_db\"]}[Data],",
        "    #\"dbo_16-18_Maths_&_Science_A2023\" = a_levels_study_db{[Schema=\"dbo\",Item=\"16-18_Maths_&_Science_A2023\"]}[Data],",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"dbo_16-18_Maths_&_Science_A2023\",{{\"Ref\", \"URN\"}}),",
        "    #\"Removed Columns\" = Table.RemoveColumns(#\"Renamed Columns\",{\"Region\", \"Gender_info\", \"School_type\"}),",
        "    #\"Divided Column\" = Table.TransformColumns(#\"Removed Columns\", {{\"A_level_maths_percent_all\", each _ / 100, type number}}),",
        "    #\"Divided Column1\" = Table.TransformColumns(#\"Divided Column\", {{\"A_level_further_maths_percent_all\", each _ / 100, type number}}),",
        "    #\"Divided Column2\" = Table.TransformColumns(#\"Divided Column1\", {{\"A_level_biological_sciences_percent_all\", each _ / 100, type number}}),",
        "    #\"Divided Column3\" = Table.TransformColumns(#\"Divided Column2\", {{\"A_level_biological_sciences_percent_all\", each _ / 100, type number}}),",
        "    #\"Divided Column4\" = Table.TransformColumns(#\"Divided Column3\", {{\"A_level_chemistry_percent_all\", each _ / 100, type number}}),",
        "    #\"Divided Column5\" = Table.TransformColumns(#\"Divided Column4\", {{\"A_level_physics_percent_all\", each _ / 100, type number}}),",
        "    #\"Divided Column6\" = Table.TransformColumns(#\"Divided Column5\", {{\"A_level_computer_sciences_percent_all\", each _ / 100, type number}}),",
        "    #\"Divided Column7\" = Table.TransformColumns(#\"Divided Column6\", {{\"A_level_maths_percent_female\", each _ / 100, type number}}),",
        "    #\"Divided Column8\" = Table.TransformColumns(#\"Divided Column7\", {{\"A_level_further_maths_percent_female\", each _ / 100, type number}}),",
        "    #\"Divided Column9\" = Table.TransformColumns(#\"Divided Column8\", {{\"A_level_biological_sciences_percent_female\", each _ / 100, type number}}),",
        "    #\"Divided Column10\" = Table.TransformColumns(#\"Divided Column9\", {{\"A_level_chemistry_percent_female\", each _ / 100, type number}}),",
        "    #\"Divided Column11\" = Table.TransformColumns(#\"Divided Column10\", {{\"A_level_physics_percent_female\", each _ / 100, type number}}),",
        "    #\"Divided Column12\" = Table.TransformColumns(#\"Divided Column11\", {{\"A_level_computer_sciences_percent_female\", each _ / 100, type number}}),",
        "    #\"Divided Column13\" = Table.TransformColumns(#\"Divided Column12\", {{\"A_level_Maths_percent_male\", each _ / 100, type number}}),",
        "    #\"Divided Column14\" = Table.TransformColumns(#\"Divided Column13\", {{\"A_level_further_maths_percent_male\", each _ / 100, type number}}),",
        "    #\"Divided Column15\" = Table.TransformColumns(#\"Divided Column14\", {{\"A_level_biological_sciences_percent_male\", each _ / 100, type number}}),",
        "    #\"Divided Column16\" = Table.TransformColumns(#\"Divided Column15\", {{\"A_level_chemistry_percent_male\", each _ / 100, type number}}),",
        "    #\"Divided Column17\" = Table.TransformColumns(#\"Divided Column16\", {{\"A_level_physics_percent_male\", each _ / 100, type number}}),",
        "    #\"Divided Column18\" = Table.TransformColumns(#\"Divided Column17\", {{\"A_level_computer_sciences_percent_male\", each _ / 100, type number}}),",
        "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Divided Column18\",{{\"A_level_computer_sciences_percent_male\", Percentage.Type}, {\"A_level_physics_percent_male\", Percentage.Type}, {\"A_level_chemistry_percent_male\", Percentage.Type}, {\"A_level_biological_sciences_percent_male\", Percentage.Type}, {\"A_level_further_maths_percent_male\", Percentage.Type}, {\"A_level_Maths_percent_male\", Percentage.Type}, {\"Male_A_levels_students\", Int64.Type}, {\"A_level_computer_sciences_percent_female\", Percentage.Type}, {\"A_level_physics_percent_female\", Percentage.Type}, {\"A_level_chemistry_percent_female\", Percentage.Type}, {\"A_level_biological_sciences_percent_female\", Percentage.Type}, {\"A_level_further_maths_percent_female\", Percentage.Type}, {\"A_level_maths_percent_female\", Percentage.Type}, {\"Female_A_levels_students\", Int64.Type}, {\"A_level_computer_sciences_percent_all\", Percentage.Type}, {\"A_level_physics_percent_all\", Percentage.Type}, {\"A_level_chemistry_percent_all\", Percentage.Type}, {\"A_level_biological_sciences_percent_all\", Percentage.Type}, {\"A_level_further_maths_percent_all\", Percentage.Type}, {\"A_level_maths_percent_all\", Percentage.Type}, {\"All_A_levels_students\", Int64.Type}}),",
        "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Changed Type\",{\"School_name\"}),",
        "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Removed Columns1\",{{\"Local_Authority\", \"Local Authority\"}, {\"All_A_levels_students\", \"All Students\"}, {\"A_level_maths_percent_all\", \"A-Level Maths\"}, {\"A_level_further_maths_percent_all\", \"A-Level Further Maths\"}, {\"A_level_biological_sciences_percent_all\", \"A-Level Biology\"}, {\"A_level_chemistry_percent_all\", \"A Level Chemistry\"}, {\"A_level_physics_percent_all\", \"A-Level Physics\"}, {\"A_level_computer_sciences_percent_all\", \"A-Level Comp. Science\"}, {\"Female_A_levels_students\", \"Female Students\"}, {\"A_level_maths_percent_female\", \"A-Level Maths (Female)\"}}),",
        "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Renamed Columns1\",{\"A_level_further_maths_percent_female\", \"A_level_biological_sciences_percent_female\", \"A_level_chemistry_percent_female\", \"A_level_physics_percent_female\", \"A_level_computer_sciences_percent_female\"}),",
        "    #\"Renamed Columns2\" = Table.RenameColumns(#\"Removed Columns2\",{{\"Male_A_levels_students\", \"Male Students\"}}),",
        "    #\"Removed Columns3\" = Table.RemoveColumns(#\"Renamed Columns2\",{\"A_level_Maths_percent_male\", \"A_level_further_maths_percent_male\", \"A_level_biological_sciences_percent_male\", \"A_level_chemistry_percent_male\", \"A_level_physics_percent_male\", \"A_level_computer_sciences_percent_male\"}),",
        "    #\"Renamed Columns3\" = Table.RenameColumns(#\"Removed Columns3\",{{\"Female Students\", \"Female Science Students\"}, {\"Male Students\", \"Male Science Students\"}})",
        "in",
        "    #\"Renamed Columns3\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Databases(\\\"localhost\\\\SQLEXPRESS\\\"),\\n    a_levels_study_db = Source{[Name=\\\"a_levels_study_db\\\"]}[Data],\\n    #\\\"dbo_16-18_Maths_&_Science_A2023\\\" = a_levels_study_db{[Schema=\\\"dbo\\\",Item=\\\"16-18_Maths_&_Science_A2023\\\"]}[Data],\\n    #\\\"Renamed Columns\\\" = Table.RenameColumns(#\\\"dbo_16-18_Maths_&_Science_A2023\\\",{{\\\"Ref\\\", \\\"URN\\\"}}),\\n    #\\\"Removed Columns\\\" = Table.RemoveColumns(#\\\"Renamed Columns\\\",{\\\"Region\\\", \\\"Gender_info\\\", \\\"School_type\\\"}),\\n    #\\\"Divided Column\\\" = Table.TransformColumns(#\\\"Removed Columns\\\", {{\\\"A_level_maths_percent_all\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column1\\\" = Table.TransformColumns(#\\\"Divided Column\\\", {{\\\"A_level_further_maths_percent_all\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column2\\\" = Table.TransformColumns(#\\\"Divided Column1\\\", {{\\\"A_level_biological_sciences_percent_all\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column3\\\" = Table.TransformColumns(#\\\"Divided Column2\\\", {{\\\"A_level_biological_sciences_percent_all\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column4\\\" = Table.TransformColumns(#\\\"Divided Column3\\\", {{\\\"A_level_chemistry_percent_all\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column5\\\" = Table.TransformColumns(#\\\"Divided Column4\\\", {{\\\"A_level_physics_percent_all\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column6\\\" = Table.TransformColumns(#\\\"Divided Column5\\\", {{\\\"A_level_computer_sciences_percent_all\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column7\\\" = Table.TransformColumns(#\\\"Divided Column6\\\", {{\\\"A_level_maths_percent_female\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column8\\\" = Table.TransformColumns(#\\\"Divided Column7\\\", {{\\\"A_level_further_maths_percent_female\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column9\\\" = Table.TransformColumns(#\\\"Divided Column8\\\", {{\\\"A_level_biological_sciences_percent_female\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column10\\\" = Table.TransformColumns(#\\\"Divided Column9\\\", {{\\\"A_level_chemistry_percent_female\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column11\\\" = Table.TransformColumns(#\\\"Divided Column10\\\", {{\\\"A_level_physics_percent_female\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column12\\\" = Table.TransformColumns(#\\\"Divided Column11\\\", {{\\\"A_level_computer_sciences_percent_female\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column13\\\" = Table.TransformColumns(#\\\"Divided Column12\\\", {{\\\"A_level_Maths_percent_male\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column14\\\" = Table.TransformColumns(#\\\"Divided Column13\\\", {{\\\"A_level_further_maths_percent_male\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column15\\\" = Table.TransformColumns(#\\\"Divided Column14\\\", {{\\\"A_level_biological_sciences_percent_male\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column16\\\" = Table.TransformColumns(#\\\"Divided Column15\\\", {{\\\"A_level_chemistry_percent_male\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column17\\\" = Table.TransformColumns(#\\\"Divided Column16\\\", {{\\\"A_level_physics_percent_male\\\", each _ / 100, type number}}),\\n    #\\\"Divided Column18\\\" = Table.TransformColumns(#\\\"Divided Column17\\\", {{\\\"A_level_computer_sciences_percent_male\\\", each _ / 100, type number}}),\\n    #\\\"Changed Type\\\" = Table.TransformColumnTypes(#\\\"Divided Column18\\\",{{\\\"A_level_computer_sciences_percent_male\\\", Percentage.Type}, {\\\"A_level_physics_percent_male\\\", Percentage.Type}, {\\\"A_level_chemistry_percent_male\\\", Percentage.Type}, {\\\"A_level_biological_sciences_percent_male\\\", Percentage.Type}, {\\\"A_level_further_maths_percent_male\\\", Percentage.Type}, {\\\"A_level_Maths_percent_male\\\", Percentage.Type}, {\\\"Male_A_levels_students\\\", Int64.Type}, {\\\"A_level_computer_sciences_percent_female\\\", Percentage.Type}, {\\\"A_level_physics_percent_female\\\", Percentage.Type}, {\\\"A_level_chemistry_percent_female\\\", Percentage.Type}, {\\\"A_level_biological_sciences_percent_female\\\", Percentage.Type}, {\\\"A_level_further_maths_percent_female\\\", Percentage.Type}, {\\\"A_level_maths_percent_female\\\", Percentage.Type}, {\\\"Female_A_levels_students\\\", Int64.Type}, {\\\"A_level_computer_sciences_percent_all\\\", Percentage.Type}, {\\\"A_level_physics_percent_all\\\", Percentage.Type}, {\\\"A_level_chemistry_percent_all\\\", Percentage.Type}, {\\\"A_level_biological_sciences_percent_all\\\", Percentage.Type}, {\\\"A_level_further_maths_percent_all\\\", Percentage.Type}, {\\\"A_level_maths_percent_all\\\", Percentage.Type}, {\\\"All_A_levels_students\\\", Int64.Type}}),\\n    #\\\"Removed Columns1\\\" = Table.RemoveColumns(#\\\"Changed Type\\\",{\\\"School_name\\\"}),\\n    #\\\"Renamed Columns1\\\" = Table.RenameColumns(#\\\"Removed Columns1\\\",{{\\\"Local_Authority\\\", \\\"Local Authority\\\"}, {\\\"All_A_levels_students\\\", \\\"All Students\\\"}, {\\\"A_level_maths_percent_all\\\", \\\"A-Level Maths\\\"}, {\\\"A_level_further_maths_percent_all\\\", \\\"A-Level Further Maths\\\"}, {\\\"A_level_biological_sciences_percent_all\\\", \\\"A-Level Biology\\\"}, {\\\"A_level_chemistry_percent_all\\\", \\\"A Level Chemistry\\\"}, {\\\"A_level_physics_percent_all\\\", \\\"A-Level Physics\\\"}, {\\\"A_level_computer_sciences_percent_all\\\", \\\"A-Level Comp. Science\\\"}, {\\\"Female_A_levels_students\\\", \\\"Female Students\\\"}, {\\\"A_level_maths_percent_female\\\", \\\"A-Level Maths (Female)\\\"}}),\\n    #\\\"Removed Columns2\\\" = Table.RemoveColumns(#\\\"Renamed Columns1\\\",{\\\"A_level_further_maths_percent_female\\\", \\\"A_level_biological_sciences_percent_female\\\", \\\"A_level_chemistry_percent_female\\\", \\\"A_level_physics_percent_female\\\", \\\"A_level_computer_sciences_percent_female\\\"}),\\n    #\\\"Renamed Columns2\\\" = Table.RenameColumns(#\\\"Removed Columns2\\\",{{\\\"Male_A_levels_students\\\", \\\"Male Students\\\"}}),\\n    #\\\"Removed Columns3\\\" = Table.RemoveColumns(#\\\"Renamed Columns2\\\",{\\\"A_level_Maths_percent_male\\\", \\\"A_level_further_maths_percent_male\\\", \\\"A_level_biological_sciences_percent_male\\\", \\\"A_level_chemistry_percent_male\\\", \\\"A_level_physics_percent_male\\\", \\\"A_level_computer_sciences_percent_male\\\"}),\\n    #\\\"Renamed Columns3\\\" = Table.RenameColumns(#\\\"Removed Columns3\\\",{{\\\"Female Students\\\", \\\"Female Science Students\\\"}, {\\\"Male Students\\\", \\\"Male Science Students\\\"}})\\nin\\n    #\\\"Renamed Columns3\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "Progressions",
      "lineageTag": "da71e075-fe13-46e4-8bd0-9024399e8407",
      "text": [
        "let",
        "    Source = Sql.Databases(\"localhost\\SQLEXPRESS\"),",
        "    a_levels_study_db = Source{[Name=\"a_levels_study_db\"]}[Data],",
        "    #\"dbo_england_ks5-studest-higher_education\" = a_levels_study_db{[Schema=\"dbo\",Item=\"england_ks5-studest-higher_education\"]}[Data],",
        "    #\"Removed Columns\" = Table.RemoveColumns(#\"dbo_england_ks5-studest-higher_education\",{\"RECTYPE\", \"LEA\", \"ESTAB\", \"SCHNAME\", \"NFTYPE\", \"FEEDER\", \"ICLOSE\", \"ALL_BAND\", \"ALL_SCORE\", \"ALL_UPPER\", \"ALL_LOWER\"}),",
        "    #\"Replaced Value\" = Table.ReplaceValue(#\"Removed Columns\",\"SUPP\",\"\",Replacer.ReplaceText,{\"ALL_PROGRESSED\"}),",
        "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Replaced Value\",{{\"ALL_PROGRESSED\", Percentage.Type}}),",
        "    #\"Replaced Value1\" = Table.ReplaceValue(#\"Changed Type\",\"SP\",\"\",Replacer.ReplaceText,{\"ALL_APPREN\", \"ALL_HE\", \"ALL_TOP3RD\", \"ALL_RUSSELL\", \"ALL_OXBRIDGE\", \"ALL_HTECH\", \"ACADAGEN_COHORT\", \"ACADAGEN_PROGRESSED\", \"ACADAGEN_SCORE\", \"ACADAGEN_UPPER\", \"ACADAGEN_LOWER\", \"ACADAGEN_BAND\", \"TLEV_COHORT\", \"TLEV_PROGRESSED\", \"TLEV_SCORE\", \"TLEV_UPPER\", \"TLEV_LOWER\", \"TLEV_BAND\", \"OTHER_COHORT\", \"OTHER_PROGRESSED\", \"OTHER_SCORE\", \"OTHER_UPPER\", \"OTHER_LOWER\", \"OTHER_BAND\", \"DIS_PROGRESSED\", \"DIS_APPREN\", \"DIS_HE\", \"DIS_TOP3RD\", \"DIS_RUSSELL\", \"DIS_OXBRIDGE\", \"DIS_HTECH\"}),",
        "    #\"Replaced Value2\" = Table.ReplaceValue(#\"Replaced Value1\",\"SUPP\",\"\",Replacer.ReplaceText,{\"ALL_APPREN\", \"ALL_HE\", \"ALL_TOP3RD\", \"ALL_RUSSELL\", \"ALL_OXBRIDGE\", \"ALL_HTECH\", \"ACADAGEN_COHORT\", \"ACADAGEN_PROGRESSED\", \"ACADAGEN_SCORE\", \"ACADAGEN_UPPER\", \"ACADAGEN_LOWER\", \"ACADAGEN_BAND\", \"TLEV_COHORT\", \"TLEV_PROGRESSED\", \"TLEV_SCORE\", \"TLEV_UPPER\", \"TLEV_LOWER\", \"TLEV_BAND\", \"OTHER_COHORT\", \"OTHER_PROGRESSED\", \"OTHER_SCORE\", \"OTHER_UPPER\", \"OTHER_LOWER\", \"OTHER_BAND\", \"DIS_PROGRESSED\", \"DIS_APPREN\", \"DIS_HE\", \"DIS_TOP3RD\", \"DIS_RUSSELL\", \"DIS_OXBRIDGE\", \"DIS_HTECH\"}),",
        "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Replaced Value2\",{{\"OTHER_PROGRESSED\", Percentage.Type}}),",
        "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Changed Type1\",{\"ALL_APPREN\", \"ALL_HE\", \"ALL_TOP3RD\", \"ALL_HTECH\", \"ACADAGEN_COHORT\", \"ACADAGEN_PROGRESSED\", \"ACADAGEN_SCORE\", \"ACADAGEN_UPPER\", \"ACADAGEN_LOWER\", \"ACADAGEN_BAND\", \"TLEV_COHORT\", \"TLEV_PROGRESSED\", \"TLEV_SCORE\", \"TLEV_UPPER\", \"TLEV_LOWER\", \"TLEV_BAND\", \"OTHER_COHORT\", \"OTHER_PROGRESSED\", \"OTHER_SCORE\", \"OTHER_UPPER\", \"OTHER_LOWER\", \"OTHER_BAND\", \"DIS_PROGRESSED\", \"DIS_APPREN\", \"DIS_HE\", \"DIS_TOP3RD\", \"DIS_RUSSELL\", \"DIS_OXBRIDGE\", \"DIS_HTECH\"}),",
        "    #\"Changed Type2\" = Table.TransformColumnTypes(#\"Removed Columns1\",{{\"ALL_OXBRIDGE\", Percentage.Type}, {\"ALL_RUSSELL\", Percentage.Type}, {\"ALL_PROGRESSED\", Percentage.Type}, {\"ALL_COHORT\", Int64.Type}}),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Changed Type2\",{{\"ALL_COHORT\", \"All Students\"}, {\"ALL_PROGRESSED\", \"All Progressions\"}, {\"ALL_RUSSELL\", \"Progress to Russel Group\"}, {\"ALL_OXBRIDGE\", \"Progress to OXBRIDGE\"}}),",
        "    #\"Replaced Value3\" = Table.ReplaceValue(#\"Renamed Columns\",null,0,Replacer.ReplaceValue,{\"Progress to Russel Group\"}),",
        "    #\"Replaced Value4\" = Table.ReplaceValue(#\"Replaced Value3\",null,0,Replacer.ReplaceValue,{\"All Progressions\"}),",
        "    #\"Replaced Value5\" = Table.ReplaceValue(#\"Replaced Value4\",null,0,Replacer.ReplaceValue,{\"Progress to OXBRIDGE\"}),",
        "    #\"Changed Type3\" = Table.TransformColumnTypes(#\"Replaced Value5\",{{\"Progress to OXBRIDGE\", Percentage.Type}, {\"Progress to Russel Group\", Percentage.Type}, {\"All Progressions\", Percentage.Type}})",
        "in",
        "    #\"Changed Type3\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Databases(\\\"localhost\\\\SQLEXPRESS\\\"),\\n    a_levels_study_db = Source{[Name=\\\"a_levels_study_db\\\"]}[Data],\\n    #\\\"dbo_england_ks5-studest-higher_education\\\" = a_levels_study_db{[Schema=\\\"dbo\\\",Item=\\\"england_ks5-studest-higher_education\\\"]}[Data],\\n    #\\\"Removed Columns\\\" = Table.RemoveColumns(#\\\"dbo_england_ks5-studest-higher_education\\\",{\\\"RECTYPE\\\", \\\"LEA\\\", \\\"ESTAB\\\", \\\"SCHNAME\\\", \\\"NFTYPE\\\", \\\"FEEDER\\\", \\\"ICLOSE\\\", \\\"ALL_BAND\\\", \\\"ALL_SCORE\\\", \\\"ALL_UPPER\\\", \\\"ALL_LOWER\\\"}),\\n    #\\\"Replaced Value\\\" = Table.ReplaceValue(#\\\"Removed Columns\\\",\\\"SUPP\\\",\\\"\\\",Replacer.ReplaceText,{\\\"ALL_PROGRESSED\\\"}),\\n    #\\\"Changed Type\\\" = Table.TransformColumnTypes(#\\\"Replaced Value\\\",{{\\\"ALL_PROGRESSED\\\", Percentage.Type}}),\\n    #\\\"Replaced Value1\\\" = Table.ReplaceValue(#\\\"Changed Type\\\",\\\"SP\\\",\\\"\\\",Replacer.ReplaceText,{\\\"ALL_APPREN\\\", \\\"ALL_HE\\\", \\\"ALL_TOP3RD\\\", \\\"ALL_RUSSELL\\\", \\\"ALL_OXBRIDGE\\\", \\\"ALL_HTECH\\\", \\\"ACADAGEN_COHORT\\\", \\\"ACADAGEN_PROGRESSED\\\", \\\"ACADAGEN_SCORE\\\", \\\"ACADAGEN_UPPER\\\", \\\"ACADAGEN_LOWER\\\", \\\"ACADAGEN_BAND\\\", \\\"TLEV_COHORT\\\", \\\"TLEV_PROGRESSED\\\", \\\"TLEV_SCORE\\\", \\\"TLEV_UPPER\\\", \\\"TLEV_LOWER\\\", \\\"TLEV_BAND\\\", \\\"OTHER_COHORT\\\", \\\"OTHER_PROGRESSED\\\", \\\"OTHER_SCORE\\\", \\\"OTHER_UPPER\\\", \\\"OTHER_LOWER\\\", \\\"OTHER_BAND\\\", \\\"DIS_PROGRESSED\\\", \\\"DIS_APPREN\\\", \\\"DIS_HE\\\", \\\"DIS_TOP3RD\\\", \\\"DIS_RUSSELL\\\", \\\"DIS_OXBRIDGE\\\", \\\"DIS_HTECH\\\"}),\\n    #\\\"Replaced Value2\\\" = Table.ReplaceValue(#\\\"Replaced Value1\\\",\\\"SUPP\\\",\\\"\\\",Replacer.ReplaceText,{\\\"ALL_APPREN\\\", \\\"ALL_HE\\\", \\\"ALL_TOP3RD\\\", \\\"ALL_RUSSELL\\\", \\\"ALL_OXBRIDGE\\\", \\\"ALL_HTECH\\\", \\\"ACADAGEN_COHORT\\\", \\\"ACADAGEN_PROGRESSED\\\", \\\"ACADAGEN_SCORE\\\", \\\"ACADAGEN_UPPER\\\", \\\"ACADAGEN_LOWER\\\", \\\"ACADAGEN_BAND\\\", \\\"TLEV_COHORT\\\", \\\"TLEV_PROGRESSED\\\", \\\"TLEV_SCORE\\\", \\\"TLEV_UPPER\\\", \\\"TLEV_LOWER\\\", \\\"TLEV_BAND\\\", \\\"OTHER_COHORT\\\", \\\"OTHER_PROGRESSED\\\", \\\"OTHER_SCORE\\\", \\\"OTHER_UPPER\\\", \\\"OTHER_LOWER\\\", \\\"OTHER_BAND\\\", \\\"DIS_PROGRESSED\\\", \\\"DIS_APPREN\\\", \\\"DIS_HE\\\", \\\"DIS_TOP3RD\\\", \\\"DIS_RUSSELL\\\", \\\"DIS_OXBRIDGE\\\", \\\"DIS_HTECH\\\"}),\\n    #\\\"Changed Type1\\\" = Table.TransformColumnTypes(#\\\"Replaced Value2\\\",{{\\\"OTHER_PROGRESSED\\\", Percentage.Type}}),\\n    #\\\"Removed Columns1\\\" = Table.RemoveColumns(#\\\"Changed Type1\\\",{\\\"ALL_APPREN\\\", \\\"ALL_HE\\\", \\\"ALL_TOP3RD\\\", \\\"ALL_HTECH\\\", \\\"ACADAGEN_COHORT\\\", \\\"ACADAGEN_PROGRESSED\\\", \\\"ACADAGEN_SCORE\\\", \\\"ACADAGEN_UPPER\\\", \\\"ACADAGEN_LOWER\\\", \\\"ACADAGEN_BAND\\\", \\\"TLEV_COHORT\\\", \\\"TLEV_PROGRESSED\\\", \\\"TLEV_SCORE\\\", \\\"TLEV_UPPER\\\", \\\"TLEV_LOWER\\\", \\\"TLEV_BAND\\\", \\\"OTHER_COHORT\\\", \\\"OTHER_PROGRESSED\\\", \\\"OTHER_SCORE\\\", \\\"OTHER_UPPER\\\", \\\"OTHER_LOWER\\\", \\\"OTHER_BAND\\\", \\\"DIS_PROGRESSED\\\", \\\"DIS_APPREN\\\", \\\"DIS_HE\\\", \\\"DIS_TOP3RD\\\", \\\"DIS_RUSSELL\\\", \\\"DIS_OXBRIDGE\\\", \\\"DIS_HTECH\\\"}),\\n    #\\\"Changed Type2\\\" = Table.TransformColumnTypes(#\\\"Removed Columns1\\\",{{\\\"ALL_OXBRIDGE\\\", Percentage.Type}, {\\\"ALL_RUSSELL\\\", Percentage.Type}, {\\\"ALL_PROGRESSED\\\", Percentage.Type}, {\\\"ALL_COHORT\\\", Int64.Type}}),\\n    #\\\"Renamed Columns\\\" = Table.RenameColumns(#\\\"Changed Type2\\\",{{\\\"ALL_COHORT\\\", \\\"All Students\\\"}, {\\\"ALL_PROGRESSED\\\", \\\"All Progressions\\\"}, {\\\"ALL_RUSSELL\\\", \\\"Progress to Russel Group\\\"}, {\\\"ALL_OXBRIDGE\\\", \\\"Progress to OXBRIDGE\\\"}}),\\n    #\\\"Replaced Value3\\\" = Table.ReplaceValue(#\\\"Renamed Columns\\\",null,0,Replacer.ReplaceValue,{\\\"Progress to Russel Group\\\"}),\\n    #\\\"Replaced Value4\\\" = Table.ReplaceValue(#\\\"Replaced Value3\\\",null,0,Replacer.ReplaceValue,{\\\"All Progressions\\\"}),\\n    #\\\"Replaced Value5\\\" = Table.ReplaceValue(#\\\"Replaced Value4\\\",null,0,Replacer.ReplaceValue,{\\\"Progress to OXBRIDGE\\\"}),\\n    #\\\"Changed Type3\\\" = Table.TransformColumnTypes(#\\\"Replaced Value5\\\",{{\\\"Progress to OXBRIDGE\\\", Percentage.Type}, {\\\"Progress to Russel Group\\\", Percentage.Type}, {\\\"All Progressions\\\", Percentage.Type}})\\nin\\n    #\\\"Changed Type3\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "Other Information",
      "lineageTag": "3270f8b6-a3cb-465f-96fb-b51ff8be527e",
      "text": [
        "let",
        "    Source = Sql.Databases(\"localhost\\SQLEXPRESS\"),",
        "    a_levels_study_db = Source{[Name=\"a_levels_study_db\"]}[Data],",
        "    dbo_s_england_school_information = a_levels_study_db{[Schema=\"dbo\",Item=\"s_england_school_information\"]}[Data],",
        "    #\"Removed Columns\" = Table.RemoveColumns(dbo_s_england_school_information,{\"STREET\", \"LOCALITY\", \"ADDRESS3\"}),",
        "    #\"Filtered Rows\" = Table.SelectRows(#\"Removed Columns\", each ([SCHSTATUS] <> \"Closed\")),",
        "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Filtered Rows\",{\"CLOSEDATE\", \"ISPRIMARY\", \"ISSECONDARY\"}),",
        "    #\"Filtered Rows1\" = Table.SelectRows(#\"Removed Columns1\", each ([ISPOST16] = \"1\")),",
        "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Filtered Rows1\",{\"AGELOW\"}),",
        "    #\"Trimmed Text\" = Table.TransformColumns(Table.TransformColumnTypes(#\"Removed Columns2\", {{\"OFSTEDLASTINSP\", type text}, {\"URN\", type text}}, \"en-GB\"),{{\"OFSTEDLASTINSP\", Text.Trim, type text}, {\"OFSTEDRATING\", Text.Trim, type text}, {\"ADMPOL\", Text.Trim, type text}, {\"RELCHAR\", Text.Trim, type text}, {\"GENDER\", Text.Trim, type text}, {\"AGEHIGH\", Text.Trim, type text}, {\"ISPOST16\", Text.Trim, type text}, {\"SCHOOLTYPE\", Text.Trim, type text}, {\"MINORGROUP\", Text.Trim, type text}, {\"SCHSTATUS\", Text.Trim, type text}, {\"POSTCODE\", Text.Trim, type text}, {\"TOWN\", Text.Trim, type text}, {\"SCHNAME\", Text.Trim, type text}, {\"LAESTAB\", Text.Trim, type text}, {\"ESTAB\", Text.Trim, type text}, {\"LA\", Text.Trim, type text}, {\"LANAME\", Text.Trim, type text}, {\"URN\", Text.Trim, type text}}),",
        "    #\"Cleaned Text\" = Table.TransformColumns(#\"Trimmed Text\",{{\"OFSTEDLASTINSP\", Text.Clean, type text}, {\"OFSTEDRATING\", Text.Clean, type text}, {\"ADMPOL\", Text.Clean, type text}, {\"RELCHAR\", Text.Clean, type text}, {\"GENDER\", Text.Clean, type text}, {\"AGEHIGH\", Text.Clean, type text}, {\"ISPOST16\", Text.Clean, type text}, {\"SCHOOLTYPE\", Text.Clean, type text}, {\"MINORGROUP\", Text.Clean, type text}, {\"SCHSTATUS\", Text.Clean, type text}, {\"POSTCODE\", Text.Clean, type text}, {\"TOWN\", Text.Clean, type text}, {\"SCHNAME\", Text.Clean, type text}, {\"LAESTAB\", Text.Clean, type text}, {\"ESTAB\", Text.Clean, type text}, {\"LA\", Text.Clean, type text}, {\"LANAME\", Text.Clean, type text}, {\"URN\", Text.Clean, type text}}),",
        "    #\"Replaced Value\" = Table.ReplaceValue(#\"Cleaned Text\",null,\"No Rating\",Replacer.ReplaceValue,{\"OFSTEDRATING\"}),",
        "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Replaced Value\",{{\"OFSTEDLASTINSP\", type datetime}}),",
        "    #\"Replaced Value1\" = Table.ReplaceValue(#\"Changed Type\",\"Null\",\"None\",Replacer.ReplaceText,{\"RELCHAR\"}),",
        "    #\"Filtered Rows2\" = Table.SelectRows(#\"Replaced Value1\", each true),",
        "    #\"Replaced Value2\" = Table.ReplaceValue(#\"Filtered Rows2\",null,\"None\",Replacer.ReplaceValue,{\"RELCHAR\"}),",
        "    #\"Removed Columns3\" = Table.RemoveColumns(#\"Replaced Value2\",{\"OFSTEDRATING\", \"OFSTEDLASTINSP\", \"SCHNAME\", \"LAESTAB\", \"ESTAB\"}),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns3\",{{\"LANAME\", \"Location\"}, {\"LA\", \"LA Code\"}, {\"TOWN\", \"Town\"}, {\"POSTCODE\", \"Postcode\"}, {\"MINORGROUP\", \"Minor Group\"}, {\"SCHOOLTYPE\", \"School Type\"}, {\"AGEHIGH\", \"Age Group\"}}),",
        "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Renamed Columns\",{{\"Age Group\", Int64.Type}}),",
        "    #\"Added Conditional Column\" = Table.AddColumn(#\"Changed Type1\", \"Custom\", each if [Age Group] < 22 then \"17-21\" else if [Age Group] < 25 then \"21-25\" else \"Above 25\"),",
        "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Conditional Column\",{\"URN\", \"Location\", \"LA Code\", \"Town\", \"Postcode\", \"SCHSTATUS\", \"Minor Group\", \"School Type\", \"ISPOST16\", \"Age Group\", \"Custom\", \"GENDER\", \"RELCHAR\", \"ADMPOL\"}),",
        "    #\"Removed Columns4\" = Table.RemoveColumns(#\"Reordered Columns\",{\"Age Group\"}),",
        "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Removed Columns4\",{{\"Custom\", \"Age Group\"}, {\"GENDER\", \"Gender\"}, {\"RELCHAR\", \"Associated With\"}, {\"ADMPOL\", \"Admission Policy\"}}),",
        "    #\"Removed Columns5\" = Table.RemoveColumns(#\"Renamed Columns1\",{\"Postcode\"}),",
        "    #\"Changed Type2\" = Table.TransformColumnTypes(#\"Removed Columns5\",{{\"URN\", Int64.Type}}),",
        "    #\"Merged Queries\" = Table.NestedJoin(#\"Changed Type2\", {\"URN\"}, #\"School Information\", {\"URN\"}, \"School Information\", JoinKind.LeftOuter),",
        "    #\"Expanded School Information\" = Table.ExpandTableColumn(#\"Merged Queries\", \"School Information\", {\"Postcode\"}, {\"Postcode\"}),",
        "    #\"Reordered Columns1\" = Table.ReorderColumns(#\"Expanded School Information\",{\"URN\", \"Location\", \"LA Code\", \"Town\", \"Postcode\", \"SCHSTATUS\", \"Minor Group\", \"School Type\", \"ISPOST16\", \"Age Group\", \"Gender\", \"Associated With\", \"Admission Policy\"})",
        "in",
        "    #\"Reordered Columns1\""
      ],
      "loadAsTableDisabled": true,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "School Information",
      "lineageTag": "bd6d882f-b5e6-43fe-8006-0e7656f2f645",
      "text": [
        "let",
        "    Source = Sql.Databases(\"localhost\\SQLEXPRESS\"),",
        "    a_levels_study_db = Source{[Name=\"a_levels_study_db\"]}[Data],",
        "    dbo_s_england_school_information = a_levels_study_db{[Schema=\"dbo\",Item=\"s_england_school_information\"]}[Data],",
        "    #\"Removed Columns\" = Table.RemoveColumns(dbo_s_england_school_information,{\"LANAME\"}),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"LA\", \"LA CODE\"}}),",
        "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Renamed Columns\",{\"ESTAB\", \"LAESTAB\"}),",
        "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Removed Columns1\",{\"URN\", \"SCHNAME\", \"LA CODE\", \"STREET\", \"LOCALITY\", \"ADDRESS3\", \"TOWN\", \"POSTCODE\", \"SCHSTATUS\", \"CLOSEDATE\", \"MINORGROUP\", \"SCHOOLTYPE\", \"ISPRIMARY\", \"ISSECONDARY\", \"ISPOST16\", \"AGELOW\", \"AGEHIGH\", \"GENDER\", \"RELCHAR\", \"ADMPOL\", \"OFSTEDRATING\", \"OFSTEDLASTINSP\"}),",
        "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Reordered Columns\",{\"STREET\", \"LOCALITY\", \"ADDRESS3\", \"TOWN\"}),",
        "    #\"Filtered Rows\" = Table.SelectRows(#\"Removed Columns2\", each ([SCHSTATUS] <> \"Closed\")),",
        "    #\"Removed Columns3\" = Table.RemoveColumns(#\"Filtered Rows\",{\"CLOSEDATE\", \"ISPRIMARY\", \"ISSECONDARY\"}),",
        "    #\"Filtered Rows1\" = Table.SelectRows(#\"Removed Columns3\", each ([ISPOST16] = \"1\")),",
        "    #\"Removed Columns4\" = Table.RemoveColumns(#\"Filtered Rows1\",{\"SCHSTATUS\", \"MINORGROUP\", \"SCHOOLTYPE\", \"ISPOST16\", \"AGELOW\", \"AGEHIGH\", \"GENDER\", \"RELCHAR\", \"ADMPOL\"}),",
        "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Removed Columns4\",{{\"SCHNAME\", \"School\"}, {\"LA CODE\", \"LA Code\"}, {\"POSTCODE\", \"Postcode\"}, {\"OFSTEDRATING\", \"Ofsted Rating\"}, {\"OFSTEDLASTINSP\", \"Last Ofsted Visit\"}}),",
        "    #\"Replaced Value\" = Table.ReplaceValue(#\"Renamed Columns1\",null,\"No Rating\",Replacer.ReplaceValue,{\"Ofsted Rating\"}),",
        "    #\"Filtered Rows2\" = Table.SelectRows(#\"Replaced Value\", each [Postcode] <> null and [Postcode] <> \"\")",
        "in",
        "    #\"Filtered Rows2\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Databases(\\\"localhost\\\\SQLEXPRESS\\\"),\\n    a_levels_study_db = Source{[Name=\\\"a_levels_study_db\\\"]}[Data],\\n    dbo_s_england_school_information = a_levels_study_db{[Schema=\\\"dbo\\\",Item=\\\"s_england_school_information\\\"]}[Data],\\n    #\\\"Removed Columns\\\" = Table.RemoveColumns(dbo_s_england_school_information,{\\\"LANAME\\\"}),\\n    #\\\"Renamed Columns\\\" = Table.RenameColumns(#\\\"Removed Columns\\\",{{\\\"LA\\\", \\\"LA CODE\\\"}}),\\n    #\\\"Removed Columns1\\\" = Table.RemoveColumns(#\\\"Renamed Columns\\\",{\\\"ESTAB\\\", \\\"LAESTAB\\\"}),\\n    #\\\"Reordered Columns\\\" = Table.ReorderColumns(#\\\"Removed Columns1\\\",{\\\"URN\\\", \\\"SCHNAME\\\", \\\"LA CODE\\\", \\\"STREET\\\", \\\"LOCALITY\\\", \\\"ADDRESS3\\\", \\\"TOWN\\\", \\\"POSTCODE\\\", \\\"SCHSTATUS\\\", \\\"CLOSEDATE\\\", \\\"MINORGROUP\\\", \\\"SCHOOLTYPE\\\", \\\"ISPRIMARY\\\", \\\"ISSECONDARY\\\", \\\"ISPOST16\\\", \\\"AGELOW\\\", \\\"AGEHIGH\\\", \\\"GENDER\\\", \\\"RELCHAR\\\", \\\"ADMPOL\\\", \\\"OFSTEDRATING\\\", \\\"OFSTEDLASTINSP\\\"}),\\n    #\\\"Removed Columns2\\\" = Table.RemoveColumns(#\\\"Reordered Columns\\\",{\\\"STREET\\\", \\\"LOCALITY\\\", \\\"ADDRESS3\\\", \\\"TOWN\\\"}),\\n    #\\\"Filtered Rows\\\" = Table.SelectRows(#\\\"Removed Columns2\\\", each ([SCHSTATUS] <> \\\"Closed\\\")),\\n    #\\\"Removed Columns3\\\" = Table.RemoveColumns(#\\\"Filtered Rows\\\",{\\\"CLOSEDATE\\\", \\\"ISPRIMARY\\\", \\\"ISSECONDARY\\\"}),\\n    #\\\"Filtered Rows1\\\" = Table.SelectRows(#\\\"Removed Columns3\\\", each ([ISPOST16] = \\\"1\\\")),\\n    #\\\"Removed Columns4\\\" = Table.RemoveColumns(#\\\"Filtered Rows1\\\",{\\\"SCHSTATUS\\\", \\\"MINORGROUP\\\", \\\"SCHOOLTYPE\\\", \\\"ISPOST16\\\", \\\"AGELOW\\\", \\\"AGEHIGH\\\", \\\"GENDER\\\", \\\"RELCHAR\\\", \\\"ADMPOL\\\"}),\\n    #\\\"Renamed Columns1\\\" = Table.RenameColumns(#\\\"Removed Columns4\\\",{{\\\"SCHNAME\\\", \\\"School\\\"}, {\\\"LA CODE\\\", \\\"LA Code\\\"}, {\\\"POSTCODE\\\", \\\"Postcode\\\"}, {\\\"OFSTEDRATING\\\", \\\"Ofsted Rating\\\"}, {\\\"OFSTEDLASTINSP\\\", \\\"Last Ofsted Visit\\\"}}),\\n    #\\\"Replaced Value\\\" = Table.ReplaceValue(#\\\"Renamed Columns1\\\",null,\\\"No Rating\\\",Replacer.ReplaceValue,{\\\"Ofsted Rating\\\"}),\\n    #\\\"Filtered Rows2\\\" = Table.SelectRows(#\\\"Replaced Value\\\", each [Postcode] <> null and [Postcode] <> \\\"\\\")\\nin\\n    #\\\"Filtered Rows2\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "Region Results",
      "lineageTag": "4da7a517-61c5-4a9b-a62d-26d68c17252a",
      "text": [
        "let",
        "    Source = Sql.Databases(\"localhost\\SQLEXPRESS\"),",
        "    a_levels_study_db = Source{[Name=\"a_levels_study_db\"]}[Data],",
        "    #\"dbo_s_data-a-level-and-other-16-to-18-results\" = a_levels_study_db{[Schema=\"dbo\",Item=\"s_data-a-level-and-other-16-to-18-results\"]}[Data],",
        "    #\"Changed Type\" = Table.TransformColumnTypes(#\"dbo_s_data-a-level-and-other-16-to-18-results\",{{\"new_la_code\", Int64.Type}}),",
        "    #\"Filtered Rows\" = Table.SelectRows(#\"Changed Type\", each [old_la_code] <> null and [old_la_code] <> \"\"),",
        "    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Filtered Rows\",{{\"region_code\", Int64.Type}}),",
        "    #\"Removed Columns\" = Table.RemoveColumns(#\"Changed Type1\",{\"new_la_code\"}),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"old_la_code\", \"LA CODE\"}}),",
        "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Renamed Columns\",{\"region_code\", \"country_name\", \"country_code\", \"time_period\", \"time_identifier\", \"subject_area\", \"qualification\", \"school_type\", \"subject_name\", \"geographic_level\"}),",
        "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Removed Columns1\",{\"region_name\", \"la_name\", \"LA CODE\", \"school_type_group\", \"entry_count\", \"perc_astar_grade_achieved\", \"perc_astar_a_grade_achieved\", \"perc_astar_b_grade_achieved\", \"perc_astar_c_grade_achieved\", \"perc_astar_d_grade_achieved\", \"perc_astar_e_grade_achieved\"}),",
        "    #\"Removed Columns2\" = Table.RemoveColumns(#\"Reordered Columns\",{\"school_type_group\"}),",
        "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Removed Columns2\",{{\"region_name\", \"Region Name\"}, {\"la_name\", \"Location\"}, {\"entry_count\", \"Entries\"}, {\"perc_astar_grade_achieved\", \"A Star or above\"}, {\"perc_astar_a_grade_achieved\", \"A or above\"}, {\"perc_astar_b_grade_achieved\", \"B or above\"}, {\"perc_astar_c_grade_achieved\", \"C or above\"}, {\"perc_astar_d_grade_achieved\", \"D or above\"}, {\"perc_astar_e_grade_achieved\", \"E or above\"}}),",
        "    #\"Divided Column\" = Table.TransformColumns(#\"Renamed Columns1\", {{\"A Star or above\", each _ / 100, type number}}),",
        "    #\"Changed Type2\" = Table.TransformColumnTypes(#\"Divided Column\",{{\"A Star or above\", Percentage.Type}}),",
        "    #\"Divided Column1\" = Table.TransformColumns(#\"Changed Type2\", {{\"A or above\", each _ / 100, type number}}),",
        "    #\"Changed Type3\" = Table.TransformColumnTypes(#\"Divided Column1\",{{\"A or above\", Percentage.Type}, {\"B or above\", Percentage.Type}, {\"C or above\", Percentage.Type}, {\"D or above\", Percentage.Type}, {\"E or above\", Percentage.Type}}),",
        "    #\"Divided Column2\" = Table.TransformColumns(#\"Changed Type3\", {{\"B or above\", each _ / 100, Percentage.Type}}),",
        "    #\"Divided Column3\" = Table.TransformColumns(#\"Divided Column2\", {{\"C or above\", each _ / 100, Percentage.Type}}),",
        "    #\"Divided Column4\" = Table.TransformColumns(#\"Divided Column3\", {{\"D or above\", each _ / 100, Percentage.Type}}),",
        "    #\"Divided Column5\" = Table.TransformColumns(#\"Divided Column4\", {{\"E or above\", each _ / 100, Percentage.Type}}),",
        "    #\"Sorted Rows\" = Table.Sort(#\"Divided Column5\",{{\"A Star or above\", Order.Descending}})",
        "in",
        "    #\"Sorted Rows\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Databases(\\\"localhost\\\\SQLEXPRESS\\\"),\\n    a_levels_study_db = Source{[Name=\\\"a_levels_study_db\\\"]}[Data],\\n    #\\\"dbo_s_data-a-level-and-other-16-to-18-results\\\" = a_levels_study_db{[Schema=\\\"dbo\\\",Item=\\\"s_data-a-level-and-other-16-to-18-results\\\"]}[Data],\\n    #\\\"Changed Type\\\" = Table.TransformColumnTypes(#\\\"dbo_s_data-a-level-and-other-16-to-18-results\\\",{{\\\"new_la_code\\\", Int64.Type}}),\\n    #\\\"Filtered Rows\\\" = Table.SelectRows(#\\\"Changed Type\\\", each [old_la_code] <> null and [old_la_code] <> \\\"\\\"),\\n    #\\\"Changed Type1\\\" = Table.TransformColumnTypes(#\\\"Filtered Rows\\\",{{\\\"region_code\\\", Int64.Type}}),\\n    #\\\"Removed Columns\\\" = Table.RemoveColumns(#\\\"Changed Type1\\\",{\\\"new_la_code\\\"}),\\n    #\\\"Renamed Columns\\\" = Table.RenameColumns(#\\\"Removed Columns\\\",{{\\\"old_la_code\\\", \\\"LA CODE\\\"}}),\\n    #\\\"Removed Columns1\\\" = Table.RemoveColumns(#\\\"Renamed Columns\\\",{\\\"region_code\\\", \\\"country_name\\\", \\\"country_code\\\", \\\"time_period\\\", \\\"time_identifier\\\", \\\"subject_area\\\", \\\"qualification\\\", \\\"school_type\\\", \\\"subject_name\\\", \\\"geographic_level\\\"}),\\n    #\\\"Reordered Columns\\\" = Table.ReorderColumns(#\\\"Removed Columns1\\\",{\\\"region_name\\\", \\\"la_name\\\", \\\"LA CODE\\\", \\\"school_type_group\\\", \\\"entry_count\\\", \\\"perc_astar_grade_achieved\\\", \\\"perc_astar_a_grade_achieved\\\", \\\"perc_astar_b_grade_achieved\\\", \\\"perc_astar_c_grade_achieved\\\", \\\"perc_astar_d_grade_achieved\\\", \\\"perc_astar_e_grade_achieved\\\"}),\\n    #\\\"Removed Columns2\\\" = Table.RemoveColumns(#\\\"Reordered Columns\\\",{\\\"school_type_group\\\"}),\\n    #\\\"Renamed Columns1\\\" = Table.RenameColumns(#\\\"Removed Columns2\\\",{{\\\"region_name\\\", \\\"Region Name\\\"}, {\\\"la_name\\\", \\\"Location\\\"}, {\\\"entry_count\\\", \\\"Entries\\\"}, {\\\"perc_astar_grade_achieved\\\", \\\"A Star or above\\\"}, {\\\"perc_astar_a_grade_achieved\\\", \\\"A or above\\\"}, {\\\"perc_astar_b_grade_achieved\\\", \\\"B or above\\\"}, {\\\"perc_astar_c_grade_achieved\\\", \\\"C or above\\\"}, {\\\"perc_astar_d_grade_achieved\\\", \\\"D or above\\\"}, {\\\"perc_astar_e_grade_achieved\\\", \\\"E or above\\\"}}),\\n    #\\\"Divided Column\\\" = Table.TransformColumns(#\\\"Renamed Columns1\\\", {{\\\"A Star or above\\\", each _ / 100, type number}}),\\n    #\\\"Changed Type2\\\" = Table.TransformColumnTypes(#\\\"Divided Column\\\",{{\\\"A Star or above\\\", Percentage.Type}}),\\n    #\\\"Divided Column1\\\" = Table.TransformColumns(#\\\"Changed Type2\\\", {{\\\"A or above\\\", each _ / 100, type number}}),\\n    #\\\"Changed Type3\\\" = Table.TransformColumnTypes(#\\\"Divided Column1\\\",{{\\\"A or above\\\", Percentage.Type}, {\\\"B or above\\\", Percentage.Type}, {\\\"C or above\\\", Percentage.Type}, {\\\"D or above\\\", Percentage.Type}, {\\\"E or above\\\", Percentage.Type}}),\\n    #\\\"Divided Column2\\\" = Table.TransformColumns(#\\\"Changed Type3\\\", {{\\\"B or above\\\", each _ / 100, Percentage.Type}}),\\n    #\\\"Divided Column3\\\" = Table.TransformColumns(#\\\"Divided Column2\\\", {{\\\"C or above\\\", each _ / 100, Percentage.Type}}),\\n    #\\\"Divided Column4\\\" = Table.TransformColumns(#\\\"Divided Column3\\\", {{\\\"D or above\\\", each _ / 100, Percentage.Type}}),\\n    #\\\"Divided Column5\\\" = Table.TransformColumns(#\\\"Divided Column4\\\", {{\\\"E or above\\\", each _ / 100, Percentage.Type}}),\\n    #\\\"Sorted Rows\\\" = Table.Sort(#\\\"Divided Column5\\\",{{\\\"A Star or above\\\", Order.Descending}})\\nin\\n    #\\\"Sorted Rows\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "National_Statistics_Postcode_Lookup_UK",
      "lineageTag": "80a81ffd-f91a-4c81-8194-76705e35e15b",
      "text": [
        "let",
        "    Source = Csv.Document(File.Contents(\"C:\\Users\\aa1\\Downloads\\National_Statistics_Postcode_Lookup_UK.csv\"),[Delimiter=\",\", Columns=36, Encoding=1252, QuoteStyle=QuoteStyle.None]),",
        "    #\"Promoted Headers\" = Table.PromoteHeaders(Source, [PromoteAllScalars=true]),",
        "    #\"Changed Type\" = Table.TransformColumnTypes(#\"Promoted Headers\",{{\"Postcode 1\", type text}, {\"Postcode 2\", type text}, {\"Postcode 3\", type text}, {\"Date Introduced\", Int64.Type}, {\"User Type\", Int64.Type}, {\"Easting\", Int64.Type}, {\"Northing\", Int64.Type}, {\"Positional Quality\", Int64.Type}, {\"County Code\", type text}, {\"County Name\", type text}, {\"Local Authority Code\", type text}, {\"Local Authority Name\", type text}, {\"Ward Code\", type text}, {\"Ward Name\", type text}, {\"Country Code\", type text}, {\"Country Name\", type text}, {\"Region Code\", type text}, {\"Region Name\", type text}, {\"Parliamentary Constituency Code\", type text}, {\"Parliamentary Constituency Name\", type text}, {\"European Electoral Region Code\", type text}, {\"European Electoral Region Name\", type text}, {\"Primary Care Trust Code\", type text}, {\"Primary Care Trust Name\", type text}, {\"Lower Super Output Area Code\", type text}, {\"Lower Super Output Area Name\", type text}, {\"Middle Super Output Area Code\", type text}, {\"Middle Super Output Area Name\", type text}, {\"Output Area Classification Code\", type text}, {\"Output Area Classification Name\", type text}, {\"Longitude\", type number}, {\"Latitude\", type number}, {\"Spatial Accuracy\", type text}, {\"Last Uploaded\", type date}, {\"Location\", type text}, {\"Socrata ID\", Int64.Type}})",
        "in",
        "    #\"Changed Type\""
      ],
      "loadAsTableDisabled": true,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "Additional Information",
      "lineageTag": "91c878dd-51fd-46b4-b11e-7710ffa38495",
      "text": [
        "let",
        "    Source = Table.NestedJoin(#\"Other Information\", {\"Postcode\"}, National_Statistics_Postcode_Lookup_UK, {\"Postcode 3\"}, \"National_Statistics_Postcode_Lookup_UK\", JoinKind.LeftOuter),",
        "    #\"Expanded National_Statistics_Postcode_Lookup_UK\" = Table.ExpandTableColumn(Source, \"National_Statistics_Postcode_Lookup_UK\", {\"Postcode 3\", \"County Name\", \"Local Authority Name\", \"Ward Name\", \"Country Name\", \"Region Name\", \"Longitude\", \"Latitude\", \"Spatial Accuracy\", \"Last Uploaded\", \"Location\", \"Socrata ID\"}, {\"Postcode 3\", \"County Name\", \"Local Authority Name\", \"Ward Name\", \"Country Name\", \"Region Name\", \"Longitude\", \"Latitude\", \"Spatial Accuracy\", \"Last Uploaded\", \"Location.1\", \"Socrata ID\"}),",
        "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Expanded National_Statistics_Postcode_Lookup_UK\",{\"URN\", \"SCHSTATUS\", \"Minor Group\", \"School Type\", \"ISPOST16\", \"Age Group\", \"Gender\", \"Associated With\", \"Admission Policy\", \"Postcode\", \"Postcode 3\", \"Town\", \"LA Code\", \"Location\", \"County Name\", \"Local Authority Name\", \"Ward Name\", \"Country Name\", \"Region Name\", \"Longitude\", \"Latitude\", \"Spatial Accuracy\", \"Last Uploaded\", \"Location.1\", \"Socrata ID\"}),",
        "    #\"Removed Columns\" = Table.RemoveColumns(#\"Reordered Columns\",{\"Postcode 3\", \"LA Code\", \"Country Name\", \"Spatial Accuracy\"}),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Location.1\", \"Lat Long\"}}),",
        "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Renamed Columns\",{\"Socrata ID\", \"Postcode\", \"Town\", \"Location\", \"County Name\", \"Local Authority Name\", \"Ward Name\", \"Region Name\", \"Longitude\", \"Latitude\", \"Last Uploaded\", \"Lat Long\"}),",
        "    #\"Replaced Value\" = Table.ReplaceValue(#\"Removed Columns1\",null,\"Not Provided\",Replacer.ReplaceValue,{\"Admission Policy\"})",
        "in",
        "    #\"Replaced Value\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Table.NestedJoin(#\\\"Other Information\\\", {\\\"Postcode\\\"}, National_Statistics_Postcode_Lookup_UK, {\\\"Postcode 3\\\"}, \\\"National_Statistics_Postcode_Lookup_UK\\\", JoinKind.LeftOuter),\\n    #\\\"Expanded National_Statistics_Postcode_Lookup_UK\\\" = Table.ExpandTableColumn(Source, \\\"National_Statistics_Postcode_Lookup_UK\\\", {\\\"Postcode 3\\\", \\\"County Name\\\", \\\"Local Authority Name\\\", \\\"Ward Name\\\", \\\"Country Name\\\", \\\"Region Name\\\", \\\"Longitude\\\", \\\"Latitude\\\", \\\"Spatial Accuracy\\\", \\\"Last Uploaded\\\", \\\"Location\\\", \\\"Socrata ID\\\"}, {\\\"Postcode 3\\\", \\\"County Name\\\", \\\"Local Authority Name\\\", \\\"Ward Name\\\", \\\"Country Name\\\", \\\"Region Name\\\", \\\"Longitude\\\", \\\"Latitude\\\", \\\"Spatial Accuracy\\\", \\\"Last Uploaded\\\", \\\"Location.1\\\", \\\"Socrata ID\\\"}),\\n    #\\\"Reordered Columns\\\" = Table.ReorderColumns(#\\\"Expanded National_Statistics_Postcode_Lookup_UK\\\",{\\\"URN\\\", \\\"SCHSTATUS\\\", \\\"Minor Group\\\", \\\"School Type\\\", \\\"ISPOST16\\\", \\\"Age Group\\\", \\\"Gender\\\", \\\"Associated With\\\", \\\"Admission Policy\\\", \\\"Postcode\\\", \\\"Postcode 3\\\", \\\"Town\\\", \\\"LA Code\\\", \\\"Location\\\", \\\"County Name\\\", \\\"Local Authority Name\\\", \\\"Ward Name\\\", \\\"Country Name\\\", \\\"Region Name\\\", \\\"Longitude\\\", \\\"Latitude\\\", \\\"Spatial Accuracy\\\", \\\"Last Uploaded\\\", \\\"Location.1\\\", \\\"Socrata ID\\\"}),\\n    #\\\"Removed Columns\\\" = Table.RemoveColumns(#\\\"Reordered Columns\\\",{\\\"Postcode 3\\\", \\\"LA Code\\\", \\\"Country Name\\\", \\\"Spatial Accuracy\\\"}),\\n    #\\\"Renamed Columns\\\" = Table.RenameColumns(#\\\"Removed Columns\\\",{{\\\"Location.1\\\", \\\"Lat Long\\\"}}),\\n    #\\\"Removed Columns1\\\" = Table.RemoveColumns(#\\\"Renamed Columns\\\",{\\\"Socrata ID\\\", \\\"Postcode\\\", \\\"Town\\\", \\\"Location\\\", \\\"County Name\\\", \\\"Local Authority Name\\\", \\\"Ward Name\\\", \\\"Region Name\\\", \\\"Longitude\\\", \\\"Latitude\\\", \\\"Last Uploaded\\\", \\\"Lat Long\\\"}),\\n    #\\\"Replaced Value\\\" = Table.ReplaceValue(#\\\"Removed Columns1\\\",null,\\\"Not Provided\\\",Replacer.ReplaceValue,{\\\"Admission Policy\\\"})\\nin\\n    #\\\"Replaced Value\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "Location Information",
      "lineageTag": "2123490e-9ad7-4438-990b-5bc67f276ba7",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Databases(\"localhost\\SQLEXPRESS\"),",
        "    a_levels_study_db = Source{[Name=\"a_levels_study_db\"]}[Data],",
        "    #\"dbo_location information exported from PowerBI\" = a_levels_study_db{[Schema=\"dbo\",Item=\"location information exported from PowerBI\"]}[Data],",
        "    #\"Removed Columns\" = Table.RemoveColumns(#\"dbo_location information exported from PowerBI\",{\"Lat_Long\"}),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Local_Authority_Name\", \"Local Authority or Borough\"}}),",
        "    #\"Added Conditional Column\" = Table.AddColumn(#\"Renamed Columns\", \"Custom\", each if Text.Contains([Region_Name], \"North\") then \"North\" else if [Region_Name] = \"London\" then \"South\" else if Text.Contains([Region_Name], \"South\") then \"South\" else if Text.Contains([Region_Name], \"Midlands\") then \"Midlands\" else if Text.Contains([Region_Name], \"York\") then \"North\" else if [Region_Name] = \"East of England\" then \"South\" else \"Others\"),",
        "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Conditional Column\",{\"URN\", \"Region_Name\", \"Custom\", \"Location\", \"Local Authority or Borough\", \"Ward_Name\", \"Postcode\", \"Longitude\", \"Latitude\"}),",
        "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Reordered Columns\",{{\"Custom\", \"Region Group\"}}),",
        "    #\"Removed Columns1\" = Table.RemoveColumns(#\"Renamed Columns1\",{\"Region_Name\", \"Region Group\", \"Location\", \"Local Authority or Borough\", \"Ward_Name\"})",
        "in",
        "    #\"Removed Columns1\""
      ],
      "isDirectQuery": false,
      "lastLoadedAsTableFormulaText": "{\"IncludesReferencedQueries\":false,\"RootFormulaText\":\"let\\n    Source = Sql.Databases(\\\"localhost\\\\SQLEXPRESS\\\"),\\n    a_levels_study_db = Source{[Name=\\\"a_levels_study_db\\\"]}[Data],\\n    #\\\"dbo_location information exported from PowerBI\\\" = a_levels_study_db{[Schema=\\\"dbo\\\",Item=\\\"location information exported from PowerBI\\\"]}[Data],\\n    #\\\"Removed Columns\\\" = Table.RemoveColumns(#\\\"dbo_location information exported from PowerBI\\\",{\\\"Lat_Long\\\"}),\\n    #\\\"Renamed Columns\\\" = Table.RenameColumns(#\\\"Removed Columns\\\",{{\\\"Local_Authority_Name\\\", \\\"Local Authority or Borough\\\"}})\\nin\\n    #\\\"Renamed Columns\\\"\",\"ReferencedQueriesFormulaText\":{}}",
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "Regional Grouping",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Databases(\"localhost\\SQLEXPRESS\"),",
        "    a_levels_study_db = Source{[Name=\"a_levels_study_db\"]}[Data],",
        "    #\"dbo_location information exported from PowerBI\" = a_levels_study_db{[Schema=\"dbo\",Item=\"location information exported from PowerBI\"]}[Data],",
        "    #\"Removed Columns\" = Table.RemoveColumns(#\"dbo_location information exported from PowerBI\",{\"Lat_Long\"}),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Local_Authority_Name\", \"Local Authority or Borough\"}}),",
        "    #\"Added Conditional Column\" = Table.AddColumn(#\"Renamed Columns\", \"Custom\", each if Text.Contains([Region_Name], \"North\") then \"North\" else if [Region_Name] = \"London\" then \"South\" else if Text.Contains([Region_Name], \"South\") then \"South\" else if Text.Contains([Region_Name], \"Midlands\") then \"Midlands\" else if Text.Contains([Region_Name], \"York\") then \"North\" else if [Region_Name] = \"East of England\" then \"South\" else \"Others\"),",
        "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Conditional Column\",{\"URN\", \"Region_Name\", \"Custom\", \"Location\", \"Local Authority or Borough\", \"Ward_Name\", \"Postcode\", \"Longitude\", \"Latitude\"}),",
        "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Reordered Columns\",{{\"Custom\", \"Region Group\"}}),",
        "    #\"Removed Other Columns\" = Table.SelectColumns(#\"Renamed Columns1\",{\"Region Group\"}),",
        "    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Other Columns\"),",
        "    #\"Added Index\" = Table.AddIndexColumn(#\"Removed Duplicates\", \"Index\", 1, 1, Int64.Type),",
        "    #\"Reordered Columns1\" = Table.ReorderColumns(#\"Added Index\",{\"Index\", \"Region Group\"})",
        "in",
        "    #\"Reordered Columns1\""
      ],
      "isDirectQuery": false,
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    },
    {
      "name": "Location Information (2)",
      "navigationStepName": "Navigation",
      "text": [
        "let",
        "    Source = Sql.Databases(\"localhost\\SQLEXPRESS\"),",
        "    a_levels_study_db = Source{[Name=\"a_levels_study_db\"]}[Data],",
        "    #\"dbo_location information exported from PowerBI\" = a_levels_study_db{[Schema=\"dbo\",Item=\"location information exported from PowerBI\"]}[Data],",
        "    #\"Removed Columns\" = Table.RemoveColumns(#\"dbo_location information exported from PowerBI\",{\"Lat_Long\"}),",
        "    #\"Renamed Columns\" = Table.RenameColumns(#\"Removed Columns\",{{\"Local_Authority_Name\", \"Local Authority or Borough\"}}),",
        "    #\"Added Conditional Column\" = Table.AddColumn(#\"Renamed Columns\", \"Custom\", each if Text.Contains([Region_Name], \"North\") then \"North\" else if [Region_Name] = \"London\" then \"South\" else if Text.Contains([Region_Name], \"South\") then \"South\" else if Text.Contains([Region_Name], \"Midlands\") then \"Midlands\" else if Text.Contains([Region_Name], \"York\") then \"North\" else if [Region_Name] = \"East of England\" then \"South\" else \"Others\"),",
        "    #\"Reordered Columns\" = Table.ReorderColumns(#\"Added Conditional Column\",{\"URN\", \"Region_Name\", \"Custom\", \"Location\", \"Local Authority or Borough\", \"Ward_Name\", \"Postcode\", \"Longitude\", \"Latitude\"}),",
        "    #\"Renamed Columns1\" = Table.RenameColumns(#\"Reordered Columns\",{{\"Custom\", \"Region Group\"}}),",
        "    #\"Removed Other Columns\" = Table.SelectColumns(#\"Renamed Columns1\",{\"Region_Name\", \"Region Group\", \"Location\", \"Local Authority or Borough\", \"Ward_Name\", \"Postcode\"}),",
        "    #\"Removed Duplicates\" = Table.Distinct(#\"Removed Other Columns\", {\"Postcode\"}),",
        "    #\"Reordered Columns1\" = Table.ReorderColumns(#\"Removed Duplicates\",{\"Postcode\", \"Region_Name\", \"Region Group\", \"Location\", \"Local Authority or Borough\", \"Ward_Name\"})",
        "in",
        "    #\"Reordered Columns1\""
      ],
      "isDirectQuery": false,
      "loadAsTableDisabled": false,
      "resultType": "Table",
      "isHidden": false
    }
  ],
  "queryGroups": [],
  "culture": "en-GB",
  "firewallEnabled": true
}